var Ke=Object.defineProperty,Qe=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var Ce=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable;var be=(e,t,n)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w=(e,t)=>{for(var n in t||(t={}))et.call(t,n)&&be(e,n,t[n]);if(Ce)for(var n of Ce(t))tt.call(t,n)&&be(e,n,t[n]);return e},S=(e,t)=>Qe(e,Ze(t));import{E as Ne,i as nt,r as l,c as y,R as q,f as le,a as st,b as R,d as ot,u as O,g as at,e as s,h as Pe,j as rt,k as ce,l as lt,A as ct,F as it,m as ut,N as dt,n as mt,o as pt,p as J,S as ft,q as Se,s as ht,t as xt,H as yt}from"./vendor.705b22cd.js";function W(){return navigator.userAgent==="ClashX Runtime"}let C=null;class Et{constructor(t){this.instance=null,window.WebViewJavascriptBridge&&(this.instance=window.WebViewJavascriptBridge),this.initBridge(n=>{this.instance=n,t()})}initBridge(t){if(!W())return t==null?void 0:t(null);if(window.WebViewJavascriptBridge)return t(window.WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(t);window.WVJBCallbacks=[t];const n=document.createElement("iframe");n.style.display="none",n.src="https://__bridge_loaded__",document.documentElement.appendChild(n),setTimeout(()=>document.documentElement.removeChild(n),0)}callHandler(t,n){return new Promise(a=>{var o;(o=this.instance)==null||o.callHandler(t,n,a)})}ping(){return this.callHandler("ping")}readConfigString(){return this.callHandler("readConfigString")}getPasteboard(){return this.callHandler("getPasteboard")}getAPIInfo(){return this.callHandler("apiInfo")}setPasteboard(t){return this.callHandler("setPasteboard",t)}writeConfigWithString(t){return this.callHandler("writeConfigWithString",t)}setSystemProxy(t){return this.callHandler("setSystemProxy",t)}getStartAtLogin(){return this.callHandler("getStartAtLogin")}getProxyDelay(t){return this.callHandler("speedTest",t)}setStartAtLogin(t){return this.callHandler("setStartAtLogin",t)}isSystemProxySet(){return this.callHandler("isSystemProxySet")}}function gt(e){if(C){e();return}C=new Et(e)}var X;(function(e){e.SPEED_NOTIFY="speed-notify"})(X||(X={}));class vt{constructor(){this.EE=new Ne}notifySpeedTest(){this.EE.emit(X.SPEED_NOTIFY)}subscribe(t,n){this.EE.addListener(t,n)}unsubscribe(t,n){this.EE.removeListener(t,n)}}var ie=new vt;function K(e,t=""){return window.localStorage.getItem(e)||t}function Q(e,t){return window.localStorage.setItem(e,t)}function I(){}async function _(e){try{return[await e,null]}catch(t){return[null,t]}}function wt(e,t){const n=[],a=[];for(const o of e)t(o)?n.push(o):a.push(o);return[n,a]}function ue(e){const[t,n]=nt(e),a=l.exports.useMemo(()=>{function o(r,c){typeof r=="string"?n(i=>{const u=r,m=c;i[u]=m}):typeof r=="function"?n(r):typeof r=="object"&&n(i=>{const u=r;for(const m of Object.keys(u)){const d=m;i[d]=u[d]}})}return o},[n]);return[t,a]}function Ct(e,t=0){if(e.length<2)throw new Error("List requires at least two elements");const[n,a]=l.exports.useState(t);function o(){a((n+1)%e.length)}return{current:l.exports.useMemo(()=>e[n],[e,n]),next:o}}function de(e=!1){const[t,n]=l.exports.useState(e);function a(){n(!1)}function o(){n(!0)}return{visible:t,hide:a,show:o}}var Sn="";function H(e){const{title:t,children:n,className:a,style:o}=e;return l.exports.createElement("header",{className:y("header",a),style:o},l.exports.createElement("h1",{className:"md:text-xl"},t),l.exports.createElement("div",{className:"flex flex-auto items-center justify-end"},n))}function T(e){const{type:t,size:n=14,className:a,style:o}=e,r=y("clash-iconfont",`icon-${t}`,a),c=w({fontSize:n},o),i=S(w({},e),{className:r,style:c});return l.exports.createElement("i",w({},i))}var kn="";function me(e){const{className:t,checked:n=!1,disabled:a=!1,onChange:o=I}=e,r=y("switch",{checked:n,disabled:a},t);function c(){a||o(!n)}return l.exports.createElement("div",{className:r,onClick:c},l.exports.createElement(T,{className:"switch-icon font-bold",type:"check",size:20}))}var Fn="";function M(e){const{className:t,style:n,children:a}=e;return l.exports.createElement("div",{className:y("card",t),style:n},a)}var Dn="";function ke(e){const{options:t,value:n,onSelect:a}=e;return l.exports.createElement("div",{className:"button-select"},t.map(o=>l.exports.createElement("button",{value:o.value,key:o.value,className:y("button-select-options",{actived:n===o.value}),onClick:()=>a==null?void 0:a(o.value)},o.label)))}const bt={SideBar:{Proxies:"Proxies",Overview:"Overview",Logs:"Logs",Rules:"Rules",Settings:"Setting",Connections:"Connections",Version:"Version"},Settings:{title:"Settings",labels:{startAtLogin:"Start at login",language:"language",setAsSystemProxy:"Set as system proxy",allowConnectFromLan:"Allow connect from Lan",proxyMode:"Mode",socks5ProxyPort:"Socks5 proxy port",httpProxyPort:"HTTP proxy port",mixedProxyPort:"Mixed proxy port",externalController:"External controller"},values:{cn:"\u4E2D\u6587",en:"English",global:"Global",rules:"Rules",direct:"Direct",script:"Script"},versionString:"Current ClashX is the latest version\uFF1A{{version}}",checkUpdate:"Check Update",externalControllerSetting:{title:"External Controller",note:"Please note that modifying this configuration will only configure Dashboard. Will not modify your Clash configuration file. Please make sure that the external controller address matches the address in the Clash configuration file, otherwise, Dashboard will not be able to connect to Clash.",host:"Host",port:"Port",secret:"Secret"}},Logs:{title:"Logs"},Rules:{title:"Rules",providerTitle:"Providers",providerUpdateTime:"Last updated at",ruleCount:"Rule count"},Connections:{title:"Connections",keepClosed:"Keep closed connections",total:{text:"total",upload:"upload",download:"download"},closeAll:{title:"Warning",content:"This would close all connections"},filter:{all:"All"},columns:{host:"Host",network:"Network",type:"Type",chains:"Chains",rule:"Rule",time:"Time",speed:"Speed",upload:"Upload",download:"Download",sourceIP:"Source IP"}},Proxies:{title:"Proxies",editDialog:{title:"Edit Proxy",color:"Color",name:"Name",type:"Type",server:"Server",port:"Port",password:"Password",cipher:"Cipher",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"Policy Group",providerTitle:"Providers",providerUpdateTime:"Last updated at",expandText:"Expand",collapseText:"Collapse",speedTestText:"Speed Test",breakConnectionsText:"Close connections which include the group"},Modal:{ok:"Ok",cancel:"Cancel"}},Nt={SideBar:{Proxies:"\u4EE3\u7406",Overview:"\u603B\u89C8",Logs:"\u65E5\u5FD7",Rules:"\u89C4\u5219",Settings:"\u8BBE\u7F6E",Connections:"\u8FDE\u63A5",Version:"\u7248\u672C"},Settings:{title:"\u8BBE\u7F6E",labels:{startAtLogin:"\u5F00\u673A\u65F6\u542F\u52A8",language:"\u8BED\u8A00",setAsSystemProxy:"\u8BBE\u7F6E\u4E3A\u7CFB\u7EDF\u4EE3\u7406",allowConnectFromLan:"\u5141\u8BB8\u6765\u81EA\u5C40\u57DF\u7F51\u7684\u8FDE\u63A5",proxyMode:"\u4EE3\u7406\u6A21\u5F0F",socks5ProxyPort:"Socks5 \u4EE3\u7406\u7AEF\u53E3",httpProxyPort:"HTTP \u4EE3\u7406\u7AEF\u53E3",mixedProxyPort:"\u6DF7\u5408\u4EE3\u7406\u7AEF\u53E3",externalController:"\u5916\u90E8\u63A7\u5236\u8BBE\u7F6E"},values:{cn:"\u4E2D\u6587",en:"English",global:"\u5168\u5C40",rules:"\u89C4\u5219",direct:"\u76F4\u8FDE",script:"\u811A\u672C"},versionString:"\u5F53\u524D ClashX \u5DF2\u662F\u6700\u65B0\u7248\u672C\uFF1A{{version}}",checkUpdate:"\u68C0\u67E5\u66F4\u65B0",externalControllerSetting:{title:"\u7F16\u8F91\u5916\u90E8\u63A7\u5236\u8BBE\u7F6E",note:"\u8BF7\u6CE8\u610F\uFF0C\u4FEE\u6539\u8BE5\u914D\u7F6E\u9879\u5E76\u4E0D\u4F1A\u4FEE\u6539\u4F60\u7684 Clash \u914D\u7F6E\u6587\u4EF6\uFF0C\u8BF7\u786E\u8BA4\u4FEE\u6539\u540E\u7684\u5916\u90E8\u63A7\u5236\u5730\u5740\u548C Clash \u914D\u7F6E\u6587\u4EF6\u5185\u7684\u5730\u5740\u4E00\u81F4\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4 Dashboard \u65E0\u6CD5\u8FDE\u63A5\u3002",host:"Host",port:"\u7AEF\u53E3",secret:"\u5BC6\u94A5"}},Logs:{title:"\u65E5\u5FD7"},Rules:{title:"\u89C4\u5219",providerTitle:"\u89C4\u5219\u96C6",providerUpdateTime:"\u6700\u540E\u66F4\u65B0\u4E8E",ruleCount:"\u89C4\u5219\u6761\u6570"},Connections:{title:"\u8FDE\u63A5",keepClosed:"\u4FDD\u7559\u5173\u95ED\u8FDE\u63A5",total:{text:"\u603B\u91CF",upload:"\u4E0A\u4F20",download:"\u4E0B\u8F7D"},closeAll:{title:"\u8B66\u544A",content:"\u5C06\u4F1A\u5173\u95ED\u6240\u6709\u8FDE\u63A5"},filter:{all:"\u5168\u90E8"},columns:{host:"\u57DF\u540D",network:"\u7F51\u7EDC",type:"\u7C7B\u578B",chains:"\u8282\u70B9\u94FE",rule:"\u89C4\u5219",time:"\u8FDE\u63A5\u65F6\u95F4",speed:"\u901F\u7387",upload:"\u4E0A\u4F20",download:"\u4E0B\u8F7D",sourceIP:"\u6765\u6E90 IP"}},Proxies:{title:"\u4EE3\u7406",editDialog:{title:"\u7F16\u8F91\u4EE3\u7406",color:"\u989C\u8272",name:"\u540D\u5B57",type:"\u7C7B\u578B",server:"\u670D\u52A1\u5668",port:"\u7AEF\u53E3",password:"\u5BC6\u7801",cipher:"\u52A0\u5BC6\u65B9\u5F0F",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"\u7B56\u7565\u7EC4",providerTitle:"\u4EE3\u7406\u96C6",providerUpdateTime:"\u6700\u540E\u66F4\u65B0\u4E8E",expandText:"\u5C55\u5F00",collapseText:"\u6536\u8D77",speedTestText:"\u6D4B\u901F",breakConnectionsText:"\u5207\u6362\u65F6\u6253\u65AD\u5305\u542B\u7B56\u7565\u7EC4\u7684\u8FDE\u63A5"},Modal:{ok:"\u786E \u5B9A",cancel:"\u53D6 \u6D88"}},Fe={en_US:bt,zh_CN:Nt},De="language",Ae=Object.keys(Fe);function Pt(){const e=[];if(window.navigator)if(window.navigator.languages)for(const t of window.navigator.languages)e.push(t);else window.navigator.language&&e.push(navigator.language);return e}function St(){const e=K(De);if(e&&Ae.includes(e))return e;const t=Pt();for(const n of t){if(n.includes("zh"))return"zh_CN";if(n.includes("us"))return"en_US"}return"en_US"}function kt(e){Q(De,e)}function pe(e){const[t,n]=q(e),a=l.exports.useMemo(()=>{function o(r,c){if(typeof r=="string")n(i=>le(i,u=>{const m=r,d=c;u[m]=d}));else if(typeof r=="function"){const i=r;n(u=>le(u,i))}else typeof r=="object"&&n(i=>le(i,u=>{const m=r;for(const d of Object.keys(m)){const f=d;u[f]=m[f]}}))}return o},[n]);return[t,a]}function fe(e){let t=null;return async function(){return t||(t=e(),t.catch(n=>{throw t=null,n}))}}class Le{constructor(t){this.EE=new Ne,this.innerBuffer=[],this.isClose=!1,this.config=Object.assign({bufferLength:0,retryInterval:5e3,headers:{}},t),this.config.useWebsocket?this.websocketLoop():this.loop()}websocketLoop(){var a;const t=new URL(this.config.url);t.protocol=t.protocol==="http:"?"ws:":"wss:",t.searchParams.set("token",(a=this.config.token)!=null?a:"");const n=new WebSocket(t.toString());n.addEventListener("message",o=>{const r=JSON.parse(o.data);this.EE.emit("data",[r]),this.config.bufferLength>0&&(this.innerBuffer.push(r),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}),n.addEventListener("close",()=>setTimeout(this.websocketLoop,this.config.retryInterval)),n.addEventListener("error",o=>{this.EE.emit("error",o),setTimeout(this.websocketLoop,this.config.retryInterval)})}async loop(){const[t,n]=await _(fetch(this.config.url,{mode:"cors",headers:this.config.token?{Authorization:`Bearer ${this.config.token}`}:{}}));if(n||!t.body){this.retry(n);return}const a=t.body.getReader(),o=new TextDecoder;for(;!this.isClose;){const[{value:r},c]=await _(a==null?void 0:a.read());if(c){this.retry(c);break}const u=o.decode(r).trim().split(`
`).map(m=>JSON.parse(m));this.EE.emit("data",u),this.config.bufferLength>0&&(this.innerBuffer.push(...u),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}}retry(t){this.isClose||(this.EE.emit("error",t),window.setTimeout(this.loop,this.config.retryInterval))}subscribe(t,n){this.EE.addListener(t,n)}unsubscribe(t,n){this.EE.removeListener(t,n)}buffer(){return this.innerBuffer.slice()}destory(){this.EE.removeAllListeners(),this.isClose=!0}}async function Z(){var r,c,i,u,m;if(W()){const d=await C.getAPIInfo();return{hostname:d.host,port:d.port,secret:d.secret,protocol:"http:"}}let e;{const d=document.querySelector('meta[name="external-controller"]');((r=d==null?void 0:d.content)==null?void 0:r.match(/^https?:/))&&(e=new URL(d.content))}const t=K("externalControllerAddr",(c=e==null?void 0:e.hostname)!=null?c:"127.0.0.1"),n=K("externalControllerPort",(i=e==null?void 0:e.port)!=null?i:"9090"),a=K("secret",(u=e==null?void 0:e.username)!=null?u:""),o=t==="127.0.0.1"?"http:":(m=e==null?void 0:e.protocol)!=null?m:window.location.protocol;if(!t||!n)throw new Error("can't get hostname or port");return{hostname:t,port:n,secret:a,protocol:o}}const b=fe(async()=>{const{hostname:e,port:t,secret:n,protocol:a}=await Z();return st.create({baseURL:`${a}//${e}:${t}`,headers:n?{Authorization:`Bearer ${n}`}:{}})});async function Te(){return(await b()).get("configs")}async function Y(e){return(await b()).patch("configs",e)}async function Ft(){return(await b()).get("rules")}async function Dt(){return(await b()).get("providers/proxies",{validateStatus(t){return t>=200&&t<300||t===404}}).then(t=>(t.status===404&&(t.data={providers:{}}),t))}async function At(){return(await b()).get("providers/rules")}async function Lt(e){return(await b()).put(`providers/proxies/${encodeURIComponent(e)}`)}async function Tt(e){return(await b()).put(`providers/rules/${encodeURIComponent(e)}`)}async function Bt(e){return(await b()).get(`providers/proxies/${encodeURIComponent(e)}/healthcheck`)}async function $t(){return(await b()).get("proxies")}async function he(){return(await b()).get("version")}async function Rt(e){return(await b()).get(`proxies/${encodeURIComponent(e)}/delay`,{params:{timeout:5e3,url:"http://www.gstatic.com/generate_204"}})}async function It(){return(await b()).delete("connections")}async function Ht(e){return(await b()).delete(`connections/${e}`)}async function Mt(){return(await b()).get("connections")}async function Ut(e,t){return(await b()).put(`proxies/${encodeURIComponent(e)}`,{name:t})}const Be=fe(async function(){const e=await Z(),{data:t}=await Te(),[n,a]=await _(he()),r=!!(a?"unkonwn version":n.data.version)||!0,c=`${e.protocol}//${e.hostname}:${e.port}/logs?level=${t["log-level"]}`;return new Le({url:c,bufferLength:200,token:e.secret,useWebsocket:r})}),qt=fe(async function(){const e=await Z(),[t,n]=await _(he()),o=!!(n?"unkonwn version":t.data.version)||!0,r=`${e.protocol}//${e.hostname}:${e.port}/connections`;return new Le({url:r,bufferLength:200,token:e.secret,useWebsocket:o})}),Ot=R({key:"identity",default:!0});function xe(){const[e,t]=q(Ot);function n(a){return async function(...o){const[r,c]=await _(a(...o)),i=c;if(i&&(!i.response||i.response.status===401))throw t(!1),c;return t(!0),r}}return{identity:e,wrapFetcher:n,set:t}}const _t=R({key:"i18n",default:St()});function N(){const[e,t]=q(_t);function n(o){t(o),kt(o)}const a=l.exports.useCallback(function(o){function r(c){return at(Fe[e][o],c)}return{t:r}},[e]);return{lang:e,locales:Ae,setLang:n,translation:a}}const $e=R({key:"version",default:{version:"",premium:!1}});function Re(){const[e,t]=q($e),{set:n}=xe();async function a(){const[o,r]=await _(he());n(!r),t(r?{version:"",premium:!1}:{version:o.data.version,premium:!!o.data.premium})}return{version:e.version,premium:e.premium,update:a}}const zt=R({key:"config",default:{breakConnections:!1}});function Ie(){const[e,t]=pe(zt);return{data:e,set:t}}const He=R({key:"proxyProvider",default:[]});function Me(){const[e,t]=q(He),{data:n,mutate:a}=O("/providers/proxy",async()=>{const o=await Dt();return Object.keys(o.data.providers).map(r=>o.data.providers[r]).filter(r=>r.name!=="default").filter(r=>r.vehicleType!=="Compatible")});return l.exports.useEffect(()=>t(n!=null?n:[]),[n,t]),{providers:e,update:a}}function Ue(){const[{premium:e}]=q($e),{data:t,mutate:n}=O("/providers/rule",async()=>{if(!e)return[];const a=await At();return Object.keys(a.data.providers).map(o=>a.data.providers[o])});return{providers:t!=null?t:[],update:n}}function qe(){const{data:e,mutate:t}=O("/config",async()=>{var o;const a=(await Te()).data;return{port:a.port,socksPort:a["socks-port"],mixedPort:(o=a["mixed-port"])!=null?o:0,redirPort:a["redir-port"],mode:a.mode.toLowerCase(),logLevel:a["log-level"],allowLan:a["allow-lan"]}});return{general:e!=null?e:{},update:t}}const Oe=R({key:"proxies",default:{proxies:[],groups:[],global:{name:"GLOBAL",type:"Selector",now:"",history:[],all:[]}}});function ee(){const[e,t]=pe(Oe),{mutate:n}=O("/proxies",async()=>{const o=await $t(),r=o.data.proxies.GLOBAL;r.name="GLOBAL";const c=new Set(["Selector","URLTest","Fallback","LoadBalance"]),i=new Set(["DIRECT","REJECT","GLOBAL"]),u=r.all.filter(f=>!i.has(f)).map(f=>S(w({},o.data.proxies[f]),{name:f})),[m,d]=wt(u,f=>!c.has(f.type));t({proxies:m,groups:d,global:r})}),a=l.exports.useCallback((o,r)=>{t(c=>{for(const i of c.groups)i.name===o&&(i.now=r)})},[t]);return{proxies:e.proxies,groups:e.groups,global:e.global,update:n,markProxySelected:a,set:t}}const Wt=ot({key:"proxyMapping",get:({get:e})=>{const t=e(Oe),n=e(He),a=new Map;for(const o of t.proxies)a.set(o.name,o);for(const o of n)for(const r of o.proxies)a.set(r.name,r);return a}});function _e(){const{data:e,mutate:t}=O("/clashx",async()=>{var o,r;if(!W())return{isClashX:!1,startAtLogin:!1,systemProxy:!1};const n=(o=await(C==null?void 0:C.getStartAtLogin()))!=null?o:!1,a=(r=await(C==null?void 0:C.isSystemProxySet()))!=null?r:!1;return{startAtLogin:n,systemProxy:a,isClashX:!0}});return{data:e,update:t}}const jt=R({key:"apiData",default:{hostname:"127.0.0.1",port:"9090",secret:""}});function ze(){const[e,t]=q(jt),n=l.exports.useCallback(async function(){const r=await Z();t(w({},r))},[t]);async function a(o){const{hostname:r,port:c,secret:i}=o;Q("externalControllerAddr",r),Q("externalControllerPort",c),Q("secret",i),window.location.reload()}return{data:e,fetch:n,update:a}}const Gt=R({key:"rules",default:[]});function Vt(){const[e,t]=pe(Gt);async function n(){const a=await Ft();t(a.data.rules)}return{rules:e,update:n}}var An="";function Jt(e){const{className:t,data:n,onClick:a,select:o,canClick:r,errSet:c,rowHeight:i}=e,{translation:u}=N(),{t:m}=u("Proxies"),[d,f]=l.exports.useState(!1),[E,k]=l.exports.useState(!1),P=l.exports.useRef(null);l.exports.useLayoutEffect(()=>{var F,L;k(((L=(F=P==null?void 0:P.current)==null?void 0:F.offsetHeight)!=null?L:0)>30)},[]);const A=d?"auto":i,B=r?a:I;function U(){f(!d)}const D=n.map(F=>{const L=y({"tags-selected":o===F,"cursor-pointer":r,error:c==null?void 0:c.has(F)});return s.createElement("li",{className:L,key:F,onClick:()=>B(F)},F)});return s.createElement("div",{className:y("flex items-start overflow-y-hidden",t),style:{height:A}},s.createElement("ul",{ref:P,className:y("tags",{expand:d})},D),E&&s.createElement("span",{className:"h-7 px-5 select-none cursor-pointer leading-7",onClick:U},m(d?"collapseText":"expandText")))}var Ln="";function j(e){const{className:t,style:n,value:a="",align:o="center",inside:r=!1,autoFocus:c=!1,type:i="text",disabled:u=!1,onChange:m=I,onBlur:d=I}=e,f=y("input",`text-${o}`,{"focus:shadow-none":r},t);return l.exports.createElement("input",{disabled:u,className:f,style:n,value:a,autoFocus:c,type:i,onChange:E=>m(E.target.value,E),onBlur:d})}var Tn="",Bn="";function We(e){const{show:t=!0,title:n="Modal",size:a="small",footer:o=!0,onOk:r=I,onClose:c=I,bodyClassName:i,bodyStyle:u,className:m,style:d,children:f}=e,{translation:E}=N(),{t:k}=E("Modal"),P=l.exports.useRef(document.createElement("div")),A=l.exports.useRef(null);l.exports.useLayoutEffect(()=>{const D=P.current;return document.body.appendChild(D),()=>{document.body.removeChild(D)}},[]);function B(D){D.target===A.current&&c()}const U=s.createElement("div",{className:y("modal-mask",{"modal-show":t}),ref:A,onMouseDown:B},s.createElement("div",{className:y("modal",`modal-${a}`,m),style:d},s.createElement("div",{className:"modal-title"},n),s.createElement("div",{className:y("modal-body",i),style:u},f),o&&s.createElement("div",{className:"footer"},s.createElement(je,{onClick:()=>c()},k("cancel")),s.createElement(je,{type:"primary",onClick:()=>r()},k("ok")))));return Pe.exports.createPortal(U,P.current)}var $n="";const Xt={success:"check",info:"info",warning:"info",error:"close"};function Yt(e){const{message:t="",type:n="info",inside:a=!1,children:o,className:r,style:c}=e,i=y("alert",`alert-${a?"note":"box"}-${n}`,r);return s.createElement("div",{className:i,style:c},s.createElement("span",{className:"alert-icon"},s.createElement(T,{type:Xt[n],size:26})),t?s.createElement("p",{className:"alert-message"},t):s.createElement("div",{className:"alert-message"},o))}var Rn="";function je(e){const{type:t="normal",onClick:n=I,children:a,className:o,style:r}=e,c=y("button",`button-${t}`,o);return l.exports.createElement("button",{className:c,style:r,onClick:n},a)}var In="",Hn="";function Ge(e){const{className:t,checked:n=!1,onChange:a=I}=e,o=y("checkbox",{checked:n},t);function r(){a(!n)}return l.exports.createElement("div",{className:o,onClick:r},l.exports.createElement(T,{className:"checkbox-icon",type:"check",size:18}),l.exports.createElement("div",null,e.children))}var Mn="";function te(e){const{color:t,className:n,style:a}=e,o=y("tag",n),r=w({color:t},a),c=S(w({},e),{className:o,style:r});return l.exports.createElement("span",w({},c),e.children)}var Un="";function Kt(e){const t=y("spinner",e.className);return l.exports.createElement("div",{className:t},l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})),l.exports.createElement("div",{className:"spinner-circle"},l.exports.createElement("div",{className:"spinner-inner"})))}var qn="";function Qt(e){const t=y("loading","visible",e.className);return e.visible?s.createElement("div",{className:t},s.createElement(Kt,{className:e.spinnerClassName})):null}var On="";const Ve={"#909399":0,"#00c520":260,"#ff9a28":600,"#ff3e5e":Infinity};async function Zt(e){var n;if(W())return(n=await(C==null?void 0:C.getProxyDelay(e)))!=null?n:0;const{data:{delay:t}}=await Rt(e);return t}function Je(e){const{config:t,className:n}=e,{set:a}=ee(),o=l.exports.useCallback(async function(){const[m,d]=await _(Zt(t.name)),f=d?0:m;a(E=>{const k=E.proxies.find(P=>P.name===t.name);k&&k.history.push({time:Date.now().toString(),delay:f})})},[t.name,a]),r=l.exports.useMemo(()=>{var m;return((m=t.history)==null?void 0:m.length)?t.history.slice(-1)[0].delay:0},[t]);l.exports.useLayoutEffect(()=>(ie.subscribe(X.SPEED_NOTIFY,o),()=>ie.unsubscribe(X.SPEED_NOTIFY,o)),[o]);const c=l.exports.useMemo(()=>r===0,[r]),i=l.exports.useMemo(()=>Object.keys(Ve).find(m=>r<=Ve[m]),[r]),u=c?void 0:i;return s.createElement("div",{className:y("proxy-item",{"proxy-error":c},n)},s.createElement("span",{className:"proxy-type",style:{backgroundColor:u}},t.type),s.createElement("p",{className:"proxy-name"},t.name),s.createElement("p",{className:"proxy-delay"},r===0?"-":`${r}ms`))}var _n="";function en(e){const{markProxySelected:t}=ee(),n=rt(Wt),{data:a}=Ie(),{config:o}=e;async function r(u){if(await Ut(e.config.name,u),t(e.config.name,u),a.breakConnections){const m=[],d=await Mt();for(const f of d.data.connections)f.chains.includes(e.config.name)&&m.push(f.id);for(const f of m)Ht(f)}}const c=l.exports.useMemo(()=>{var m;const u=new Set;for(const d of o.all){const f=(m=n.get(d))==null?void 0:m.history;(f==null?void 0:f.length)&&f.slice(-1)[0].delay===0&&u.add(d)}return u},[o.all,n]),i=o.type==="Selector";return s.createElement("div",{className:"proxy-group"},s.createElement("div",{className:"proxy-group-part"},s.createElement("span",{className:"proxy-group-name"},o.name),s.createElement(te,{className:"proxy-group-type"},o.type)),s.createElement("div",{className:"proxy-group-tags-container"},s.createElement(Jt,{className:"proxy-group-tags",data:o.all,onClick:r,errSet:c,select:o.now,canClick:i,rowHeight:30})))}ce.extend(lt);function ye(e,t){const n=t==="en_US"?"en":"zh-cn";return ce().locale(n).from(e)}var zn="";function tn(e){const{update:t}=Me(),{translation:n,lang:a}=N(),{provider:o}=e,{t:r}=n("Proxies"),{visible:c,hide:i,show:u}=de();function m(){u(),Bt(o.name).then(()=>t()).finally(()=>i())}function d(){u(),Lt(o.name).then(()=>t()).finally(()=>i())}const f=l.exports.useMemo(()=>o.proxies.slice().sort((E,k)=>-1*Ee(E,k)),[o.proxies]);return l.exports.createElement(M,{className:"proxy-provider"},l.exports.createElement(Qt,{visible:c}),l.exports.createElement("div",{className:"proxy-provider-header"},l.exports.createElement("div",{className:"proxy-provider-header-part"},l.exports.createElement("span",{className:"proxy-provider-name"},o.name),l.exports.createElement(te,null,o.vehicleType)),l.exports.createElement("div",{className:"proxy-provider-header-part"},o.updatedAt&&l.exports.createElement("span",{className:"proxy-provider-update"},`${r("providerUpdateTime")}: ${ye(new Date(o.updatedAt),a)}`),l.exports.createElement(T,{className:"proxy-provider-icon healthcheck",type:"healthcheck",size:18,onClick:m}),l.exports.createElement(T,{className:"proxy-provider-icon",type:"update",size:18,onClick:d}))),l.exports.createElement("ul",{className:"proxies-list"},f.map(E=>l.exports.createElement("li",{key:E.name},l.exports.createElement(Je,{className:"proxy-provider-item",config:E})))))}var Wn="",Xe;(function(e){e[e.None=0]="None",e[e.Asc=1]="Asc",e[e.Desc=2]="Desc"})(Xe||(Xe={}));const nn={[0]:"sort",[1]:"sort-ascending",[2]:"sort-descending"};function Ee(e,t){const n=e.history.length?e.history.slice(-1)[0].delay:0;return((t.history.length?t.history.slice(-1)[0].delay:0)||Number.MAX_SAFE_INTEGER)-(n||Number.MAX_SAFE_INTEGER)}function sn(){const{groups:e,global:t}=ee(),{data:n,set:a}=Ie(),{general:o}=qe(),{translation:r}=N(),{t:c}=r("Proxies"),i=l.exports.useMemo(()=>o.mode==="global"?[t]:e,[o,e,t]);return s.createElement(s.Fragment,null,i.length!==0&&s.createElement("div",{className:"proxies-container"},s.createElement(H,{title:c("groupTitle")},s.createElement(Ge,{className:"text-primary-600 text-sm text-shadow-primary cursor-pointer",checked:n.breakConnections,onChange:u=>a("breakConnections",u)},c("breakConnectionsText"))),s.createElement(M,{className:"my-3 md:my-5 p-0"},s.createElement("ul",{className:"list-none"},i.map(u=>s.createElement("li",{className:"proxies-group-item",key:u.name},s.createElement(en,{config:u})))))))}function on(){const{providers:e}=Me(),{translation:t}=N(),{t:n}=t("Proxies");return s.createElement(s.Fragment,null,e.length!==0&&s.createElement("div",{className:"proxies-container"},s.createElement(H,{title:n("providerTitle")}),s.createElement("ul",{className:"list-none"},e.map(a=>s.createElement("li",{className:"my-5",key:a.name},s.createElement(tn,{provider:a}))))))}function an(){const{proxies:e}=ee(),{translation:t}=N(),{t:n}=t("Proxies");function a(){ie.notifySpeedTest()}const{current:o,next:r}=Ct([1,2,0]),c=l.exports.useMemo(()=>{switch(o){case 2:return e.slice().sort((u,m)=>Ee(u,m));case 1:return e.slice().sort((u,m)=>-1*Ee(u,m));default:return e.slice()}},[o,e]),i=r;return s.createElement(s.Fragment,null,c.length!==0&&s.createElement("div",{className:"proxies-container"},s.createElement(H,{title:n("title")},s.createElement(T,{className:"ml-3",type:nn[o],onClick:i,size:20}),s.createElement(T,{className:"ml-3",type:"speed",size:20}),s.createElement("span",{className:"proxies-speed-test",onClick:a},n("speedTestText"))),s.createElement("ul",{className:"proxies-list"},c.map(u=>s.createElement("li",{key:u.name},s.createElement(Je,{config:u}))))))}function rn(){return s.createElement("div",{className:"page"},s.createElement(sn,null),s.createElement(on,null),s.createElement(an,null))}var jn="";function ln(){const e=l.exports.useRef(null),t=l.exports.useRef([]),[n,a]=l.exports.useState([]),{translation:o}=N(),{t:r}=o("Logs");return l.exports.useLayoutEffect(()=>{const c=e.current;c&&(c.scrollTop=c.scrollHeight)}),l.exports.useEffect(()=>{let c=null;function i(u){t.current=t.current.slice().concat(u.map(m=>S(w({},m),{time:new Date}))),a(t.current)}return async function(){c=await Be(),t.current=c.buffer(),a(t.current),c.subscribe("data",i)}(),()=>c==null?void 0:c.unsubscribe("data",i)},[]),s.createElement("div",{className:"page"},s.createElement(H,{title:r("title")}),s.createElement(M,{className:"flex flex-col flex-1 mt-3"},s.createElement("ul",{className:"logs-panel",ref:e},n.map((c,i)=>s.createElement("li",{className:"leading-5 inline-block",key:i},s.createElement("span",{className:"mr-4 text-gray-400 text-opacity-90"},ce(c.time).format("YYYY-MM-DD HH:mm:ss")),s.createElement("span",null,"[",c.type,"] ",c.payload))))))}var Gn="";function cn(e){const{update:t}=Ue(),{translation:n,lang:a}=N(),{provider:o}=e,{t:r}=n("Rules"),{visible:c,hide:i,show:u}=de();function m(){u(),Tt(o.name).then(()=>t()).finally(()=>i())}const d=y("rule-provider-icon",{"rule-provider-loading":c});return l.exports.createElement(M,{className:"rule-provider"},l.exports.createElement("div",{className:"rule-provider-header"},l.exports.createElement("div",{className:"rule-provider-header-part"},l.exports.createElement("span",{className:"rule-provider-name"},o.name),l.exports.createElement(te,null,o.vehicleType),l.exports.createElement(te,{className:"rule-provider-behavior"},o.behavior),l.exports.createElement("span",{className:"rule-provider-update"},`${r("ruleCount")}: ${o.ruleCount}`)),l.exports.createElement("div",{className:"rule-provider-header-part"},o.updatedAt&&l.exports.createElement("span",{className:"rule-provider-update"},`${r("providerUpdateTime")}: ${ye(new Date(o.updatedAt),a)}`),l.exports.createElement(T,{className:d,type:"update",size:18,onClick:m}))))}var Vn="";function un(){const{providers:e}=Ue(),{translation:t}=N(),{t:n}=t("Rules");return s.createElement(s.Fragment,null,e.length!==0&&s.createElement("div",{className:"proxies-container"},s.createElement(H,{title:n("providerTitle")}),s.createElement("ul",{className:"proxies-providers-list"},e.map(a=>s.createElement("li",{className:"proxies-providers-item",key:a.name},s.createElement(cn,{provider:a}))))))}function dn(){const{rules:e,update:t}=Vt(),{translation:n}=N(),{t:a}=n("Rules");O("rules",t);function o({index:r,style:c}){const i=e[r];return s.createElement("li",{className:"rule-item",style:c},s.createElement("div",{className:"py-1 flex"},s.createElement("div",{className:"rule-type w-40 text-center"},i.type),s.createElement("div",{className:"payload flex-1 text-center"},i.payload),s.createElement("div",{className:"rule-proxy w-40 text-center"},i.proxy)))}return s.createElement("div",{className:"page"},s.createElement(un,null),s.createElement(H,{title:a("title")}),s.createElement(M,{className:"flex flex-col flex-1 mt-3 p-0 focus:outline-none"},s.createElement(ct,{className:"rules"},({height:r,width:c})=>s.createElement(it,{height:r,width:c,itemCount:e.length,itemSize:50},o))))}var Jn="";const mn=[{label:"\u4E2D\u6587",value:"zh_CN"},{label:"English",value:"en_US"}];function pn(){var p,g,v;const{premium:e}=Re(),{data:t,update:n}=_e(),{general:a,update:o}=qe(),{set:r}=xe(),{data:c}=ze(),{translation:i,setLang:u,lang:m}=N(),{t:d}=i("Settings"),[f,E]=ue({socks5ProxyPort:7891,httpProxyPort:7890,mixedProxyPort:0});l.exports.useEffect(()=>{var x,ve,we;E("socks5ProxyPort",(x=a==null?void 0:a.socksPort)!=null?x:0),E("httpProxyPort",(ve=a==null?void 0:a.port)!=null?ve:0),E("mixedProxyPort",(we=a==null?void 0:a.mixedPort)!=null?we:0)},[a,E]);async function k(x){await Y({mode:x}),await o()}async function P(x){await(C==null?void 0:C.setStartAtLogin(x)),n()}async function A(x){await(C==null?void 0:C.setSystemProxy(x)),n()}function B(x){u(x)}async function U(){await Y({port:f.httpProxyPort}),await o()}async function D(){await Y({"socks-port":f.socks5ProxyPort}),await o()}async function F(){await Y({"mixed-port":f.mixedProxyPort}),await o()}async function L(x){await Y({"allow-lan":x}),await o()}const{hostname:ne,port:se}=c,{allowLan:G,mode:V}=a,oe=(p=t==null?void 0:t.startAtLogin)!=null?p:!1,ae=(g=t==null?void 0:t.systemProxy)!=null?g:!1,$=(v=t==null?void 0:t.isClashX)!=null?v:!1,re=l.exports.useMemo(()=>{const x=[{label:d("values.global"),value:"Global"},{label:d("values.rules"),value:"Rule"},{label:d("values.direct"),value:"Direct"}];return e&&x.push({label:d("values.script"),value:"Script"}),x},[d,e]);return s.createElement("div",{className:"page"},s.createElement(H,{title:d("title")}),s.createElement(M,{className:"settings-card"},s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.startAtLogin")),s.createElement(me,{disabled:!(t==null?void 0:t.isClashX),checked:oe,onChange:P})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.language")),s.createElement(ke,{options:mn,value:m,onSelect:x=>B(x)}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.setAsSystemProxy")),s.createElement(me,{disabled:!$,checked:ae,onChange:A})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.allowConnectFromLan")),s.createElement(me,{checked:G,onChange:L})))),s.createElement(M,{className:"settings-card"},s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.proxyMode")),s.createElement(ke,{options:re,value:ut(V),onSelect:k})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.socks5ProxyPort")),s.createElement(j,{className:"w-28",disabled:$,value:f.socks5ProxyPort,onChange:x=>E("socks5ProxyPort",+x),onBlur:D}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.httpProxyPort")),s.createElement(j,{className:"w-28",disabled:$,value:f.httpProxyPort,onChange:x=>E("httpProxyPort",+x),onBlur:U})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.mixedProxyPort")),s.createElement(j,{className:"w-28",disabled:$,value:f.mixedProxyPort,onChange:x=>E("mixedProxyPort",+x),onBlur:F}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},d("labels.externalController")),s.createElement("span",{className:y({"modify-btn":!$},"external-controller"),onClick:()=>!$&&r(!1)},`${ne}:${se}`)),s.createElement("div",{className:"w-1/2 px-8"}))))}var Xn="",fn="./assets/logo.b453e72f.png";function hn(e){const{routes:t}=e,{translation:n}=N(),{version:a,premium:o,update:r}=Re(),{data:c}=_e(),{t:i}=n("SideBar");O("version",r);const u=t.map(({path:m,name:d,exact:f,noMobile:E})=>l.exports.createElement("li",{className:y("item",{"no-mobile":E}),key:d},l.exports.createElement(dt,{to:m,activeClassName:"active",exact:!!f},i(d))));return l.exports.createElement("div",{className:"sidebar"},l.exports.createElement("img",{src:fn,alt:"logo",className:"sidebar-logo"}),l.exports.createElement("ul",{className:"sidebar-menu"},u),l.exports.createElement("div",{className:"sidebar-version"},l.exports.createElement("span",{className:"sidebar-version-label"},"Clash",(c==null?void 0:c.isClashX)&&"X"," ",i("Version")),l.exports.createElement("span",{className:"sidebar-version-text"},a),o&&l.exports.createElement("span",{className:"sidebar-version-label"},"Premium")))}var ge;(function(e){e.Domain="Domain",e.DomainSuffix="DomainSuffix",e.DomainKeyword="DomainKeyword",e.GeoIP="GeoIP",e.IPCIDR="IPCIDR",e.SrcIPCIDR="SrcIPCIDR",e.SrcPort="SrcPort",e.DstPort="DstPort",e.MATCH="MATCH",e.RuleSet="RuleSet"})(ge||(ge={}));var Yn="";function xn(e){const{translation:t}=N(),n=l.exports.useMemo(()=>t("Connections").t,[t]),{className:a,style:o}=e,r=y("connections-devices",a);function c(i){var u;(u=e.onChange)==null||u.call(e,i)}return s.createElement("div",{className:r,style:o},s.createElement("div",{className:y("connections-devices-item",{selected:e.selected===""}),onClick:()=>c("")},n("filter.all")),e.devices.map(i=>s.createElement("div",{key:i.label,className:y("connections-devices-item",{selected:e.selected===i.label}),onClick:()=>c(i.label)},i.label," (",i.number,")")))}class yn{constructor(){this.connections=new Map,this.saveDisconnection=!1}appendToSet(t){var a;const n=t.reduce((o,r)=>o.set(r.id,r),new Map);for(const o of this.connections.keys())if(!n.has(o))if(!this.saveDisconnection)this.connections.delete(o);else{const r=this.connections.get(o);r&&(r.completed=!0,r.uploadSpeed=0,r.downloadSpeed=0)}for(const o of n.keys()){if(!this.connections.has(o)){this.connections.set(o,S(w({},n.get(o)),{uploadSpeed:0,downloadSpeed:0}));continue}const r=this.connections.get(o),c=n.get(o);(a=this.connections)==null||a.set(o,S(w({},c),{uploadSpeed:c.upload-r.upload,downloadSpeed:c.download-r.download}))}}toggleSave(){var t,n;if(this.saveDisconnection){this.saveDisconnection=!1;for(const a of this.connections.keys())((n=(t=this.connections)==null?void 0:t.get(a))==null?void 0:n.completed)&&this.connections.delete(a)}else this.saveDisconnection=!0;return this.saveDisconnection}getConnections(){return[...this.connections.values()]}}function En(){const e=l.exports.useMemo(()=>new yn,[]),t=l.exports.useRef(!0),[n,a]=l.exports.useState([]),[o,r]=l.exports.useState(!1),c=l.exports.useCallback(function(u){e.appendToSet(u),t.current&&a(e.getConnections()),t.current=!t.current},[e]),i=l.exports.useCallback(function(){const u=e.toggleSave();r(u),u||a(e.getConnections()),t.current=!0},[e]);return{connections:n,feed:c,toggleSave:i,save:o}}var Kn="",h;(function(e){e.Host="host",e.Network="network",e.Type="type",e.Chains="chains",e.Rule="rule",e.Speed="speed",e.Upload="upload",e.Download="download",e.SourceIP="sourceIP",e.Time="time"})(h||(h={}));const gn=new Set([h.Network,h.Type,h.Rule,h.Speed,h.Upload,h.Download,h.SourceIP,h.Time]);function z(e){const t=["B","KB","MB","GB","TB"];let n=0;for(;~~(e/1024)&&n<t.length;)e/=1024,n++;return`${n===0?e:e.toFixed(2)} ${t[n]}`}function vn(e,t){switch(!0){case(e===0&&t===0):return"-";case(e!==0&&t!==0):return`\u2191 ${z(e)}/s \u2193 ${z(t)}/s`;case e!==0:return`\u2191 ${z(e)}/s`;default:return`\u2193 ${z(t)}/s`}}function wn(){const{translation:e,lang:t}=N(),n=l.exports.useMemo(()=>e("Connections").t,[e]),[a,o]=ue({uploadTotal:0,downloadTotal:0}),{visible:r,show:c,hide:i}=de();function u(){It().finally(()=>i())}const{connections:m,feed:d,save:f,toggleSave:E}=En(),k=l.exports.useMemo(()=>m.map(p=>({id:p.id,host:`${p.metadata.host||p.metadata.destinationIP}:${p.metadata.destinationPort}`,chains:p.chains.slice().reverse().join(" / "),rule:p.rule===ge.RuleSet?`${p.rule}(${p.rulePayload})`:p.rule,time:new Date(p.start).getTime(),upload:p.upload,download:p.download,sourceIP:p.metadata.sourceIP,type:p.metadata.type,network:p.metadata.network.toUpperCase(),speed:{upload:p.uploadSpeed,download:p.downloadSpeed},completed:!!p.completed})),[m]),P=l.exports.useMemo(()=>{const p=mt(m,"metadata.sourceIP");return Object.keys(p).map(g=>({label:g,number:p[g].length})).sort((g,v)=>g.label.localeCompare(v.label))},[m]),A=l.exports.useRef(null),{x:B}=pt(A),U=l.exports.useMemo(()=>[{Header:n(`columns.${h.Host}`),accessor:h.Host,minWidth:260,width:260},{Header:n(`columns.${h.Network}`),accessor:h.Network,minWidth:80,width:80},{Header:n(`columns.${h.Type}`),accessor:h.Type,minWidth:120,width:120},{Header:n(`columns.${h.Chains}`),accessor:h.Chains,minWidth:200,width:200},{Header:n(`columns.${h.Rule}`),accessor:h.Rule,minWidth:140,width:140},{id:h.Speed,Header:n(`columns.${h.Speed}`),accessor(p){return[p.speed.upload,p.speed.download]},sortType(p,g){const v=p.original.speed,x=g.original.speed;return v.download===x.download?v.upload-x.upload:v.download-x.download},minWidth:200,width:200,sortDescFirst:!0},{Header:n(`columns.${h.Upload}`),accessor:h.Upload,minWidth:100,width:100,sortDescFirst:!0},{Header:n(`columns.${h.Download}`),accessor:h.Download,minWidth:100,width:100,sortDescFirst:!0},{Header:n(`columns.${h.SourceIP}`),accessor:h.SourceIP,minWidth:140,width:140},{Header:n(`columns.${h.Time}`),accessor:h.Time,minWidth:120,width:120,sortType(p,g){return g.original.time-p.original.time}}],[n]);l.exports.useLayoutEffect(()=>{let p=null;function g(v){for(const x of v)o({uploadTotal:x.uploadTotal,downloadTotal:x.downloadTotal}),d(x.connections)}return async function(){p=await qt(),p.subscribe("data",g)}(),()=>{p&&(p.unsubscribe("data",g),p.destory())}},[d,o]);const{getTableProps:D,getTableBodyProps:F,headerGroups:L,rows:ne,prepareRow:se,setFilter:G}=J.exports.useTable({columns:U,data:k,autoResetSortBy:!1,autoResetFilters:!1,initialState:{sortBy:[{id:h.Time,desc:!1}]}},J.exports.useResizeColumns,J.exports.useBlockLayout,J.exports.useFilters,J.exports.useSortBy),V=l.exports.useMemo(()=>L[0],[L]),oe=l.exports.useCallback(function(p){switch(p.column.id){case h.Speed:return vn(p.value[0],p.value[1]);case h.Upload:case h.Download:return z(p.value);case h.Time:return ye(new Date(p.value),t);default:return p.value}},[t]),[ae,$]=l.exports.useState("");function re(p){$(p),G==null||G(h.SourceIP,p)}return s.createElement("div",{className:"page"},s.createElement(H,{title:n("title")},s.createElement("span",{className:"connections-filter flex-1 cursor-default"},`(${n("total.text")}: ${n("total.upload")} ${z(a.uploadTotal)} ${n("total.download")} ${z(a.downloadTotal)})`),s.createElement(Ge,{className:"connections-filter",checked:f,onChange:E},n("keepClosed")),s.createElement(T,{className:"connections-filter dangerous",onClick:c,type:"close-all",size:20})),P.length>1&&s.createElement(xn,{devices:P,selected:ae,onChange:re}),s.createElement(M,{className:"connections-card"},s.createElement("div",S(w({},D()),{className:"flex flex-col w-full flex-1 overflow-auto",style:{flexBasis:0},ref:A}),s.createElement("div",S(w({},V.getHeaderGroupProps()),{className:"connections-header"}),V.headers.map((p,g)=>{const v=p,x=v.id;return s.createElement("div",S(w({},v.getHeaderProps()),{className:y("connections-th",{resizing:v.isResizing,fixed:B>0&&v.id===h.Host}),key:x}),s.createElement("div",w({},v.getSortByToggleProps()),p.render("Header"),v.isSorted?v.isSortedDesc?" \u2193":" \u2191":null),g!==V.headers.length-1&&s.createElement("div",S(w({},v.getResizerProps()),{className:"connections-resizer"})))})),s.createElement("div",S(w({},F()),{className:"flex-1"}),ne.map(p=>(se(p),s.createElement("div",S(w({},p.getRowProps()),{className:"connections-item",key:p.original.id}),p.cells.map(g=>{const v=y("connections-block",{"text-center":gn.has(g.column.id),completed:p.original.completed},{fixed:B>0&&g.column.id===h.Host});return s.createElement("div",S(w({},g.getCellProps()),{className:v,key:g.column.id}),oe(g))}))))))),s.createElement(We,{title:n("closeAll.title"),show:r,onClose:i,onOk:u},n("closeAll.content")))}var Qn="";function Cn(){const{translation:e}=N(),{t}=e("Settings"),{data:n,update:a,fetch:o}=ze(),{identity:r,set:c}=xe(),[i,u]=ue({hostname:"",port:"",secret:""});l.exports.useEffect(()=>{o()},[o]),l.exports.useEffect(()=>{u({hostname:n.hostname,port:n.port,secret:n.secret})},[n,u]);function m(){const{hostname:d,port:f,secret:E}=i;a({hostname:d,port:f,secret:E})}return s.createElement(We,{show:!r,title:t("externalControllerSetting.title"),bodyClassName:"external-controller",onClose:()=>c(!0),onOk:m},s.createElement(Yt,{type:"info",inside:!0},s.createElement("p",null,t("externalControllerSetting.note"))),s.createElement("div",{className:"flex items-center"},s.createElement("span",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.host")),s.createElement(j,{className:"md:my-3 flex-1 my-1",align:"left",inside:!0,value:i.hostname,onChange:d=>u("hostname",d)})),s.createElement("div",{className:"flex items-center"},s.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.port")),s.createElement(j,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.port,onChange:d=>u("port",d)})),s.createElement("div",{className:"flex items-center"},s.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.secret")),s.createElement(j,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.secret,onChange:d=>u("secret",d)})))}var Zn="",es="";function bn(){l.exports.useEffect(()=>{Be()},[]);const e=[{path:"/proxies",name:"Proxies",component:rn},{path:"/logs",name:"Logs",component:ln},{path:"/rules",name:"Rules",component:dn,noMobile:!0},{path:"/connections",name:"Connections",component:wn,noMobile:!0},{path:"/settings",name:"Settings",component:pn}];return s.createElement("div",{className:y("app",{"not-clashx":!W()})},s.createElement(hn,{routes:e}),s.createElement("div",{className:"page-container"},s.createElement(ft,null,s.createElement(Se,{exact:!0,path:"/",component:()=>s.createElement(ht,{to:"/proxies"})}),e.map(t=>s.createElement(Se,{exact:!1,path:t.path,key:t.path,component:t.component})))),s.createElement(Cn,null))}var ts="";function Ye(){const e=document.getElementById("root"),t=s.createElement(xt,null,s.createElement(yt,null,s.createElement(bn,null)));Pe.exports.render(t,e)}W()?gt(()=>Ye()):Ye();
