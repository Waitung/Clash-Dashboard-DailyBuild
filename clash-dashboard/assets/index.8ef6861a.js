var Ye=Object.defineProperty,qe=Object.defineProperties;var Ke=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var Qe=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable;var Ce=(t,e,n)=>e in t?Ye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,C=(t,e)=>{for(var n in e||(e={}))Qe.call(e,n)&&Ce(t,n,e[n]);if(we)for(var n of we(e))Ze.call(e,n)&&Ce(t,n,e[n]);return t},k=(t,e)=>qe(t,Ke(e));import{E as be,i as et,r as c,c as y,f as Ne,a as tt,b as le,d as z,u as Pe,e as nt,g as B,R as te,h as Se,j as ce,k as _,l as st,m as s,n as ke,o as ie,p as ot,A as rt,F as at,q as lt,N as ct,s as it,t as ut,v as K,S as mt,w as Fe,x as dt,H as pt}from"./vendor.d85e6789.js";function J(){return navigator.userAgent==="ClashX Runtime"}let b=null;class ft{constructor(e){this.instance=null,window.WebViewJavascriptBridge&&(this.instance=window.WebViewJavascriptBridge),this.initBridge(n=>{this.instance=n,e()})}initBridge(e){if(!J())return e==null?void 0:e(null);if(window.WebViewJavascriptBridge)return e(window.WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];const n=document.createElement("iframe");n.style.display="none",n.src="https://__bridge_loaded__",document.documentElement.appendChild(n),setTimeout(()=>document.documentElement.removeChild(n),0)}callHandler(e,n){return new Promise(o=>{var r;(r=this.instance)==null||r.callHandler(e,n,o)})}ping(){return this.callHandler("ping")}readConfigString(){return this.callHandler("readConfigString")}getPasteboard(){return this.callHandler("getPasteboard")}getAPIInfo(){return this.callHandler("apiInfo")}setPasteboard(e){return this.callHandler("setPasteboard",e)}writeConfigWithString(e){return this.callHandler("writeConfigWithString",e)}setSystemProxy(e){return this.callHandler("setSystemProxy",e)}getStartAtLogin(){return this.callHandler("getStartAtLogin")}getProxyDelay(e){return this.callHandler("speedTest",e)}setStartAtLogin(e){return this.callHandler("setStartAtLogin",e)}isSystemProxySet(){return this.callHandler("isSystemProxySet")}}function ht(t){if(b){t();return}b=new ft(t)}var Q;(function(t){t.SPEED_NOTIFY="speed-notify"})(Q||(Q={}));class xt{constructor(){this.EE=new be}notifySpeedTest(){this.EE.emit(Q.SPEED_NOTIFY)}subscribe(e,n){this.EE.addListener(e,n)}unsubscribe(e,n){this.EE.removeListener(e,n)}}var ue=new xt;function H(){}function Et(t,e){const n=[],o=[];for(const r of t)e(r)?n.push(r):o.push(r);return[n,o]}function me(t){const[e,n]=et(t),o=c.exports.useMemo(()=>{function r(a,l){typeof a=="string"?n(i=>{const u=a,d=l;i[u]=d}):typeof a=="function"?n(a):typeof a=="object"&&n(i=>{const u=a;for(const d of Object.keys(u)){const p=d;i[p]=u[p]}})}return r},[n]);return[e,o]}function gt(t,e=0){if(t.length<2)throw new Error("List requires at least two elements");const[n,o]=c.exports.useState(e);function r(){o((n+1)%t.length)}return{current:c.exports.useMemo(()=>t[n],[t,n]),next:r}}function de(t=!1){const[e,n]=c.exports.useState(t);function o(){n(!1)}function r(){n(!0)}return{visible:e,hide:o,show:r}}function U(t){const{title:e,children:n,className:o,style:r}=t;return c.exports.createElement("header",{className:y("header",o),style:r},c.exports.createElement("h1",{className:"md:text-xl"},e),c.exports.createElement("div",{className:"flex flex-auto items-center justify-end"},n))}function I(t){const{type:e,size:n=14,className:o,style:r}=t,a=y("clash-iconfont",`icon-${e}`,o),l=C({fontSize:n},r),i=k(C({},t),{className:a,style:l});return c.exports.createElement("i",C({},i))}function pe(t){const{className:e,checked:n=!1,disabled:o=!1,onChange:r=H}=t,a=y("switch",{checked:n,disabled:o},e);function l(){o||r(!n)}return c.exports.createElement("div",{className:a,onClick:l},c.exports.createElement(I,{className:"switch-icon font-bold",type:"check",size:20}))}function O(t){const{className:e,style:n,children:o}=t;return c.exports.createElement("div",{className:y("card",e),style:n},o)}function Ae(t){const{options:e,value:n,onSelect:o}=t;return c.exports.createElement("div",{className:"button-select"},e.map(r=>c.exports.createElement("button",{value:r.value,key:r.value,className:y("button-select-options",{actived:n===r.value}),onClick:()=>o==null?void 0:o(r.value)},r.label)))}const yt={SideBar:{Proxies:"Proxies",Overview:"Overview",Logs:"Logs",Rules:"Rules",Settings:"Setting",Connections:"Connections",Version:"Version"},Settings:{title:"Settings",labels:{startAtLogin:"Start at login",language:"language",setAsSystemProxy:"Set as system proxy",allowConnectFromLan:"Allow connect from Lan",proxyMode:"Mode",socks5ProxyPort:"Socks5 proxy port",httpProxyPort:"HTTP proxy port",mixedProxyPort:"Mixed proxy port",externalController:"External controller"},values:{cn:"\u4E2D\u6587",en:"English",global:"Global",rules:"Rules",direct:"Direct",script:"Script"},versionString:"Current ClashX is the latest version\uFF1A{{version}}",checkUpdate:"Check Update",externalControllerSetting:{title:"External Controller",note:"Please note that modifying this configuration will only configure Dashboard. Will not modify your Clash configuration file. Please make sure that the external controller address matches the address in the Clash configuration file, otherwise, Dashboard will not be able to connect to Clash.",host:"Host",port:"Port",secret:"Secret"}},Logs:{title:"Logs"},Rules:{title:"Rules",providerTitle:"Providers",providerUpdateTime:"Last updated at",ruleCount:"Rule count"},Connections:{title:"Connections",keepClosed:"Keep closed connections",total:{text:"total",upload:"upload",download:"download"},closeAll:{title:"Warning",content:"This would close all connections"},filter:{all:"All"},columns:{host:"Host",network:"Network",type:"Type",chains:"Chains",rule:"Rule",time:"Time",speed:"Speed",upload:"Upload",download:"Download",sourceIP:"Source IP"}},Proxies:{title:"Proxies",editDialog:{title:"Edit Proxy",color:"Color",name:"Name",type:"Type",server:"Server",port:"Port",password:"Password",cipher:"Cipher",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"Policy Group",providerTitle:"Providers",providerUpdateTime:"Last updated at",expandText:"Expand",collapseText:"Collapse",speedTestText:"Speed Test",breakConnectionsText:"Close connections which include the group"},Modal:{ok:"Ok",cancel:"Cancel"}},vt={SideBar:{Proxies:"\u4EE3\u7406",Overview:"\u603B\u89C8",Logs:"\u65E5\u5FD7",Rules:"\u89C4\u5219",Settings:"\u8BBE\u7F6E",Connections:"\u8FDE\u63A5",Version:"\u7248\u672C"},Settings:{title:"\u8BBE\u7F6E",labels:{startAtLogin:"\u5F00\u673A\u65F6\u542F\u52A8",language:"\u8BED\u8A00",setAsSystemProxy:"\u8BBE\u7F6E\u4E3A\u7CFB\u7EDF\u4EE3\u7406",allowConnectFromLan:"\u5141\u8BB8\u6765\u81EA\u5C40\u57DF\u7F51\u7684\u8FDE\u63A5",proxyMode:"\u4EE3\u7406\u6A21\u5F0F",socks5ProxyPort:"Socks5 \u4EE3\u7406\u7AEF\u53E3",httpProxyPort:"HTTP \u4EE3\u7406\u7AEF\u53E3",mixedProxyPort:"\u6DF7\u5408\u4EE3\u7406\u7AEF\u53E3",externalController:"\u5916\u90E8\u63A7\u5236\u8BBE\u7F6E"},values:{cn:"\u4E2D\u6587",en:"English",global:"\u5168\u5C40",rules:"\u89C4\u5219",direct:"\u76F4\u8FDE",script:"\u811A\u672C"},versionString:"\u5F53\u524D ClashX \u5DF2\u662F\u6700\u65B0\u7248\u672C\uFF1A{{version}}",checkUpdate:"\u68C0\u67E5\u66F4\u65B0",externalControllerSetting:{title:"\u7F16\u8F91\u5916\u90E8\u63A7\u5236\u8BBE\u7F6E",note:"\u8BF7\u6CE8\u610F\uFF0C\u4FEE\u6539\u8BE5\u914D\u7F6E\u9879\u5E76\u4E0D\u4F1A\u4FEE\u6539\u4F60\u7684 Clash \u914D\u7F6E\u6587\u4EF6\uFF0C\u8BF7\u786E\u8BA4\u4FEE\u6539\u540E\u7684\u5916\u90E8\u63A7\u5236\u5730\u5740\u548C Clash \u914D\u7F6E\u6587\u4EF6\u5185\u7684\u5730\u5740\u4E00\u81F4\uFF0C\u5426\u5219\u4F1A\u5BFC\u81F4 Dashboard \u65E0\u6CD5\u8FDE\u63A5\u3002",host:"Host",port:"\u7AEF\u53E3",secret:"\u5BC6\u94A5"}},Logs:{title:"\u65E5\u5FD7"},Rules:{title:"\u89C4\u5219",providerTitle:"\u89C4\u5219\u96C6",providerUpdateTime:"\u6700\u540E\u66F4\u65B0\u4E8E",ruleCount:"\u89C4\u5219\u6761\u6570"},Connections:{title:"\u8FDE\u63A5",keepClosed:"\u4FDD\u7559\u5173\u95ED\u8FDE\u63A5",total:{text:"\u603B\u91CF",upload:"\u4E0A\u4F20",download:"\u4E0B\u8F7D"},closeAll:{title:"\u8B66\u544A",content:"\u5C06\u4F1A\u5173\u95ED\u6240\u6709\u8FDE\u63A5"},filter:{all:"\u5168\u90E8"},columns:{host:"\u57DF\u540D",network:"\u7F51\u7EDC",type:"\u7C7B\u578B",chains:"\u8282\u70B9\u94FE",rule:"\u89C4\u5219",time:"\u8FDE\u63A5\u65F6\u95F4",speed:"\u901F\u7387",upload:"\u4E0A\u4F20",download:"\u4E0B\u8F7D",sourceIP:"\u6765\u6E90 IP"}},Proxies:{title:"\u4EE3\u7406",editDialog:{title:"\u7F16\u8F91\u4EE3\u7406",color:"\u989C\u8272",name:"\u540D\u5B57",type:"\u7C7B\u578B",server:"\u670D\u52A1\u5668",port:"\u7AEF\u53E3",password:"\u5BC6\u7801",cipher:"\u52A0\u5BC6\u65B9\u5F0F",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"\u7B56\u7565\u7EC4",providerTitle:"\u4EE3\u7406\u96C6",providerUpdateTime:"\u6700\u540E\u66F4\u65B0\u4E8E",expandText:"\u5C55\u5F00",collapseText:"\u6536\u8D77",speedTestText:"\u6D4B\u901F",breakConnectionsText:"\u5207\u6362\u65F6\u6253\u65AD\u5305\u542B\u7B56\u7565\u7EC4\u7684\u8FDE\u63A5"},Modal:{ok:"\u786E \u5B9A",cancel:"\u53D6 \u6D88"}},De={en_US:yt,zh_CN:vt},wt=Object.keys(De);function Ct(){for(const t of window.navigator.languages){if(t.includes("zh"))return"zh_CN";if(t.includes("us"))return"en_US"}return"en_US"}function fe(t){return c.exports.useMemo(()=>{function n(o,r){if(typeof o=="string")t(a=>{const l=o,i=r;a[l]=i});else if(typeof o=="function"){const a=o;t(l=>a(l))}else typeof o=="object"&&t(a=>Ne(a,l=>{const i=o;for(const u of Object.keys(i)){const d=u;l[d]=i[d]}}))}return n},[t])}class bt{constructor(e,n){this.axiosClient=tt.create({baseURL:e,headers:n?{Authorization:`Bearer ${n}`}:{}})}getConfig(){return this.axiosClient.get("configs")}updateConfig(e){return this.axiosClient.patch("configs",e)}getRules(){return this.axiosClient.get("rules")}async getProxyProviders(){const e=await this.axiosClient.get("providers/proxies",{validateStatus(n){return n>=200&&n<300||n===404}});return e.status===404&&(e.data={providers:{}}),e}getRuleProviders(){return this.axiosClient.get("providers/rules")}updateProvider(e){return this.axiosClient.put(`providers/proxies/${encodeURIComponent(e)}`)}updateRuleProvider(e){return this.axiosClient.put(`providers/rules/${encodeURIComponent(e)}`)}healthCheckProvider(e){return this.axiosClient.get(`providers/proxies/${encodeURIComponent(e)}/healthcheck`)}getProxies(){return this.axiosClient.get("proxies")}getProxy(e){return this.axiosClient.get(`proxies/${encodeURIComponent(e)}`)}getVersion(){return this.axiosClient.get("version")}getProxyDelay(e){return this.axiosClient.get(`proxies/${encodeURIComponent(e)}/delay`,{params:{timeout:5e3,url:"http://www.gstatic.com/generate_204"}})}closeAllConnections(){return this.axiosClient.delete("connections")}closeConnection(e){return this.axiosClient.delete(`connections/${e}`)}getConnections(){return this.axiosClient.get("connections")}changeProxySelected(e,n){return this.axiosClient.put(`proxies/${encodeURIComponent(e)}`,{name:n})}}const Nt=z(async()=>{if(!J())return null;const t=await b.getAPIInfo();return{hostname:t.host,port:t.port,secret:t.secret,protocol:"http:"}}),Le=le("externalControllers",[]);function Z(){var d,p,m,x,E,w,F,D,L,S,N,T,j,W,V;const t=Pe(Nt),e=nt(),n=Pe(Le);if(t)return t;let o;{const $=document.querySelector('meta[name="external-controller"]');((d=$==null?void 0:$.content)==null?void 0:d.match(/^https?:/))&&(o=new URL($.content))}const r=new URLSearchParams(e.search),a=(E=(x=(m=r.get("host"))!=null?m:(p=n==null?void 0:n[0])==null?void 0:p.hostname)!=null?x:o==null?void 0:o.hostname)!=null?E:"127.0.0.1",l=(L=(D=(F=r.get("port"))!=null?F:(w=n==null?void 0:n[0])==null?void 0:w.port)!=null?D:o==null?void 0:o.port)!=null?L:"9090",i=(j=(T=(N=r.get("secret"))!=null?N:(S=n==null?void 0:n[0])==null?void 0:S.secret)!=null?T:o==null?void 0:o.username)!=null?j:"",u=((W=r.get("protocol"))!=null?W:a==="127.0.0.1")?"http:":(V=o==null?void 0:o.protocol)!=null?V:window.location.protocol;return{hostname:a,port:l,secret:i,protocol:u}}const Pt=z({key:"",instance:null});function A(){const{hostname:t,port:e,secret:n,protocol:o}=Z(),[r,a]=B(Pt),l=`${o}//${t}:${e}?secret=${n}`;if(r.key===l)return r.instance;const i=new bt(`${o}//${t}:${e}`,n);return a({key:l,instance:i}),i}class Te{constructor(e){this.EE=new be,this.innerBuffer=[],this.isClose=!1,this.config=Object.assign({bufferLength:0,retryInterval:5e3,headers:{}},e),this.config.useWebsocket?this.websocketLoop():this.loop()}websocketLoop(){var o;const e=new URL(this.config.url);e.protocol=e.protocol==="http:"?"ws:":"wss:",e.searchParams.set("token",(o=this.config.token)!=null?o:"");const n=new WebSocket(e.toString());n.addEventListener("message",r=>{const a=JSON.parse(r.data);this.EE.emit("data",[a]),this.config.bufferLength>0&&(this.innerBuffer.push(a),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}),n.addEventListener("close",()=>setTimeout(this.websocketLoop,this.config.retryInterval)),n.addEventListener("error",r=>{this.EE.emit("error",r),setTimeout(this.websocketLoop,this.config.retryInterval)})}async loop(){const e=await te.fromPromise(fetch(this.config.url,{mode:"cors",headers:this.config.token?{Authorization:`Bearer ${this.config.token}`}:{}}),r=>r);if(e.isErr()){this.retry(e.error);return}else if(!e.value.body){this.retry(new Error("fetch body error"));return}const n=e.value.body.getReader(),o=new TextDecoder;for(;!this.isClose;){const r=await te.fromPromise(n==null?void 0:n.read(),i=>i);if(r.isErr()){this.retry(r.error);break}const l=o.decode(r.value.value).trim().split(`
`).map(i=>JSON.parse(i));this.EE.emit("data",l),this.config.bufferLength>0&&(this.innerBuffer.push(...l),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}}retry(e){this.isClose||(this.EE.emit("error",e),window.setTimeout(this.loop,this.config.retryInterval))}subscribe(e,n){this.EE.addListener(e,n)}unsubscribe(e,n){this.EE.removeListener(e,n)}buffer(){return this.innerBuffer.slice()}destory(){this.EE.removeAllListeners(),this.isClose=!0}}const he=z(!0),St=le("language",void 0);function P(){const[t,e]=B(St),n=c.exports.useMemo(()=>t!=null?t:Ct(),[t]),o=c.exports.useCallback(function(r){function a(l){return st(De[n][r],l)}return{t:a}},[n]);return{lang:n,locales:wt,setLang:e,translation:o}}const Be=z({version:"",premium:!1});function ne(){const[t,e]=B(Be),n=A(),o=ce(he);return _([n],async function(){const r=await te.fromPromise(n.getVersion(),a=>a);o(r.isOk()),e(r.isErr()?{version:"",premium:!1}:{version:r.value.data.version,premium:!!r.value.data.premium})}),{version:t.version,premium:t.premium}}function Ie(){const[{premium:t}]=B(Be),e=A(),{data:n,mutate:o}=_(["/providers/rule",e],async()=>{if(!t)return[];const r=await e.getRuleProviders();return Object.keys(r.data.providers).map(a=>r.data.providers[a])});return{providers:n!=null?n:[],update:o}}const kt=le("profile",{breakConnections:!1});function $e(){const[t,e]=B(kt),n=c.exports.useCallback(o=>{e(Ne(t,o))},[t,e]);return{data:t,set:fe(n)}}const Re=z([]);function Me(){const[t,e]=B(Re),n=A(),{data:o,mutate:r}=_(["/providers/proxy",n],async()=>{const a=await n.getProxyProviders();return Object.keys(a.data.providers).map(l=>a.data.providers[l]).filter(l=>l.name!=="default").filter(l=>l.vehicleType!=="Compatible")});return c.exports.useEffect(()=>e(o!=null?o:[]),[o,e]),{providers:t,update:r}}function xe(){const t=A(),{data:e,mutate:n}=_(["/config",t],async()=>{var a;const r=(await t.getConfig()).data;return{port:r.port,socksPort:r["socks-port"],mixedPort:(a=r["mixed-port"])!=null?a:0,redirPort:r["redir-port"],mode:r.mode.toLowerCase(),logLevel:r["log-level"],allowLan:r["allow-lan"]}});return{general:e!=null?e:{},update:n}}const He=Se({proxies:[],groups:[],global:{name:"GLOBAL",type:"Selector",now:"",history:[],all:[]}});function se(){const[t,e]=B(He),n=fe(e),o=A(),{mutate:r}=_(["/proxies",o],async()=>{const l=await o.getProxies(),i=l.data.proxies.GLOBAL;i.name="GLOBAL";const u=new Set(["Selector","URLTest","Fallback","LoadBalance"]),d=new Set(["DIRECT","REJECT","GLOBAL"]),p=i.all.filter(E=>!d.has(E)).map(E=>k(C({},l.data.proxies[E]),{name:E})),[m,x]=Et(p,E=>!u.has(E.type));n({proxies:m,groups:x,global:i})}),a=c.exports.useCallback((l,i)=>{n(u=>{l==="GLOBAL"&&(u.global.now=i);for(const d of u.groups)d.name===l&&(d.now=i)})},[n]);return{proxies:t.proxies,groups:t.groups,global:t.global,update:r,markProxySelected:a,set:n}}const Ft=z(t=>{const e=t(He),n=t(Re),o=new Map;for(const r of e.proxies)o.set(r.name,r);for(const r of n)for(const a of r.proxies)o.set(a.name,a);return o});function Ue(){const{data:t,mutate:e}=_("/clashx",async()=>{var r,a;if(!J())return{isClashX:!1,startAtLogin:!1,systemProxy:!1};const n=(r=await(b==null?void 0:b.getStartAtLogin()))!=null?r:!1,o=(a=await(b==null?void 0:b.isSystemProxySet()))!=null?a:!1;return{startAtLogin:n,systemProxy:o,isClashX:!0}});return{data:t,update:e}}const At=Se([]);function Dt(){const[t,e]=B(At),n=fe(e),o=A();async function r(){const a=await o.getRules();n(a.data.rules)}return{rules:t,update:r}}const Lt=z({key:"",instance:null});function Oe(){var p,m;const t=Z(),{general:e}=xe(),n=ne(),[o,r]=B(Lt);if(!n.version)return null;const a=!!n.version||!0,l=`${t.protocol}//${t.hostname}:${t.port}/logs?level=${(p=e.logLevel)!=null?p:""}&useWebsocket=${a}&secret=${t.secret}`;if(o.key===l)return o.instance;const i=o.instance,u=`${t.protocol}//${t.hostname}:${t.port}/logs?level=${(m=e.logLevel)!=null?m:""}`,d=new Te({url:u,bufferLength:200,token:t.secret,useWebsocket:a});return r({key:l,instance:d}),i&&i.destory(),d}function Tt(){const t=Z(),e=ne(),n=!!e.version||!0,o=`${t.protocol}//${t.hostname}:${t.port}/connections`;return c.exports.useMemo(()=>e.version?new Te({url:o,bufferLength:200,token:t.secret,useWebsocket:n}):null,[t.secret,o,n,e.version])}function Bt(t){const{className:e,data:n,onClick:o,select:r,canClick:a,errSet:l,rowHeight:i}=t,{translation:u}=P(),{t:d}=u("Proxies"),[p,m]=c.exports.useState(!1),[x,E]=c.exports.useState(!1),w=c.exports.useRef(null);c.exports.useLayoutEffect(()=>{var N,T;E(((T=(N=w==null?void 0:w.current)==null?void 0:N.offsetHeight)!=null?T:0)>30)},[]);const F=p?"auto":i,D=a?o:H;function L(){m(!p)}const S=n.map(N=>{const T=y({"tags-selected":r===N,"cursor-pointer":a,error:l==null?void 0:l.has(N)});return s.createElement("li",{className:T,key:N,onClick:()=>D(N)},N)});return s.createElement("div",{className:y("flex items-start overflow-y-hidden",e),style:{height:F}},s.createElement("ul",{ref:w,className:y("tags",{expand:p})},S),x&&s.createElement("span",{className:"h-7 px-5 select-none cursor-pointer leading-7",onClick:L},d(p?"collapseText":"expandText")))}function X(t){const{className:e,style:n,value:o="",align:r="center",inside:a=!1,autoFocus:l=!1,type:i="text",disabled:u=!1,onChange:d=H,onBlur:p=H}=t,m=y("input",`text-${r}`,{"focus:shadow-none":a},e);return c.exports.createElement("input",{disabled:u,className:m,style:n,value:o,autoFocus:l,type:i,onChange:x=>d(x.target.value,x),onBlur:p})}function We(t){const{show:e=!0,title:n="Modal",size:o="small",footer:r=!0,onOk:a=H,onClose:l=H,bodyClassName:i,bodyStyle:u,className:d,style:p,children:m}=t,{translation:x}=P(),{t:E}=x("Modal"),w=c.exports.useRef(document.createElement("div")),F=c.exports.useRef(null);c.exports.useLayoutEffect(()=>{const S=w.current;return document.body.appendChild(S),()=>{document.body.removeChild(S)}},[]);function D(S){S.target===F.current&&l()}const L=s.createElement("div",{className:y("modal-mask",{"modal-show":e}),ref:F,onMouseDown:D},s.createElement("div",{className:y("modal",`modal-${o}`,d),style:p},s.createElement("div",{className:"modal-title"},n),s.createElement("div",{className:y("modal-body",i),style:u},m),r&&s.createElement("div",{className:"footer"},s.createElement(ze,{onClick:()=>l()},E("cancel")),s.createElement(ze,{type:"primary",onClick:()=>a()},E("ok")))));return ke.exports.createPortal(L,w.current)}const It={success:"check",info:"info",warning:"info",error:"close"};function $t(t){const{message:e="",type:n="info",inside:o=!1,children:r,className:a,style:l}=t,i=y("alert",`alert-${o?"note":"box"}-${n}`,a);return s.createElement("div",{className:i,style:l},s.createElement("span",{className:"alert-icon"},s.createElement(I,{type:It[n],size:26})),e?s.createElement("p",{className:"alert-message"},e):s.createElement("div",{className:"alert-message"},r))}function ze(t){const{type:e="normal",onClick:n=H,children:o,className:r,style:a}=t,l=y("button",`button-${e}`,r);return c.exports.createElement("button",{className:l,style:a,onClick:n},o)}function _e(t){const{className:e,checked:n=!1,onChange:o=H}=t,r=y("checkbox",{checked:n},e);function a(){o(!n)}return c.exports.createElement("div",{className:r,onClick:a},c.exports.createElement(I,{className:"checkbox-icon",type:"check",size:18}),c.exports.createElement("div",null,t.children))}function oe(t){const{color:e,className:n,style:o}=t,r=y("tag",n),a=C({color:e},o),l=k(C({},t),{className:r,style:a});return c.exports.createElement("span",C({},l),t.children)}function Rt(t){const e=y("spinner",t.className);return c.exports.createElement("div",{className:e},c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})))}function Ge(t){const e=y("loading","visible",t.className);return t.visible?s.createElement("div",{className:e},s.createElement(Rt,{className:t.spinnerClassName})):null}const je={"#909399":0,"#00c520":260,"#ff9a28":600,"#ff3e5e":Infinity};function Ve(t){const{config:e,className:n}=t,{set:o}=se(),r=A(),a=c.exports.useCallback(async m=>{var E;if(J())return(E=await(b==null?void 0:b.getProxyDelay(m)))!=null?E:0;const{data:{delay:x}}=await r.getProxyDelay(m);return x},[r]),l=c.exports.useCallback(async function(){const m=await te.fromPromise(a(e.name),E=>E),x=m.isErr()?0:m.value;o(E=>{const w=E.proxies.find(F=>F.name===e.name);w&&w.history.push({time:Date.now().toString(),delay:x})})},[e.name,a,o]),i=c.exports.useMemo(()=>{var m;return((m=e.history)==null?void 0:m.length)?e.history.slice(-1)[0].delay:0},[e]);c.exports.useLayoutEffect(()=>(ue.subscribe(Q.SPEED_NOTIFY,l),()=>ue.unsubscribe(Q.SPEED_NOTIFY,l)),[l]);const u=c.exports.useMemo(()=>i===0,[i]),d=c.exports.useMemo(()=>Object.keys(je).find(m=>i<=je[m]),[i]),p=u?void 0:d;return s.createElement("div",{className:y("proxy-item",{"proxy-error":u},n)},s.createElement("span",{className:"proxy-type",style:{backgroundColor:p}},e.type),s.createElement("p",{className:"proxy-name"},e.name),s.createElement("p",{className:"proxy-delay"},i===0?"-":`${i}ms`))}function Mt(t){const{markProxySelected:e}=se(),[n]=B(Ft),{data:o}=$e(),r=A(),{config:a}=t;async function l(d){if(await r.changeProxySelected(t.config.name,d),e(t.config.name,d),o.breakConnections){const p=[],m=await r.getConnections();for(const x of m.data.connections)x.chains.includes(t.config.name)&&p.push(x.id);for(const x of p)r.closeConnection(x)}}const i=c.exports.useMemo(()=>{var p;const d=new Set;for(const m of a.all){const x=(p=n.get(m))==null?void 0:p.history;(x==null?void 0:x.length)&&x.slice(-1)[0].delay===0&&d.add(m)}return d},[a.all,n]),u=a.type==="Selector";return s.createElement("div",{className:"proxy-group"},s.createElement("div",{className:"w-full h-10 mt-4 flex items-center justify-between md:h-15 md:mt-0 md:w-auto"},s.createElement("span",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap px-5 h-6 w-35 md:w-30"},a.name),s.createElement(oe,{className:"mr-5 md:mr-0"},a.type)),s.createElement("div",{className:"py-2 md:py-4 flex-1"},s.createElement(Bt,{className:"ml-5 md:ml-8",data:a.all,onClick:l,errSet:i,select:a.now,canClick:u,rowHeight:30})))}ie.extend(ot);function Ee(t,e){const n=e==="en_US"?"en":"zh-cn";return ie().locale(n).from(t)}function Ht(t){const{update:e}=Me(),{translation:n,lang:o}=P(),r=A(),{provider:a}=t,{t:l}=n("Proxies"),{visible:i,hide:u,show:d}=de();function p(){d(),r.healthCheckProvider(a.name).then(()=>e()).finally(()=>u())}function m(){d(),r.updateProvider(a.name).then(()=>e()).finally(()=>u())}const x=c.exports.useMemo(()=>a.proxies.slice().sort((E,w)=>-1*ge(E,w)),[a.proxies]);return s.createElement(O,{className:"proxy-provider"},s.createElement(Ge,{visible:i}),s.createElement("div",{className:"flex justify-between flex-col md:flex-row md:items-center"},s.createElement("div",{className:"flex items-center"},s.createElement("span",{className:"mr-6"},a.name),s.createElement(oe,null,a.vehicleType)),s.createElement("div",{className:"flex items-center pt-3 md:pt-0"},a.updatedAt&&s.createElement("span",{className:"text-sm"},`${l("providerUpdateTime")}: ${Ee(new Date(a.updatedAt),o)}`),s.createElement(I,{className:"pl-5 cursor-pointer text-red",type:"healthcheck",size:18,onClick:p}),s.createElement(I,{className:"pl-5 cursor-pointer",type:"update",size:18,onClick:m}))),s.createElement("ul",{className:"proxies-list"},x.map(E=>s.createElement("li",{key:E.name},s.createElement(Ve,{className:"proxy-provider-item",config:E})))))}var Je;(function(t){t[t.None=0]="None",t[t.Asc=1]="Asc",t[t.Desc=2]="Desc"})(Je||(Je={}));const Ut={[0]:"sort",[1]:"sort-ascending",[2]:"sort-descending"};function ge(t,e){const n=t.history.length?t.history.slice(-1)[0].delay:0;return((e.history.length?e.history.slice(-1)[0].delay:0)||Number.MAX_SAFE_INTEGER)-(n||Number.MAX_SAFE_INTEGER)}function Ot(){const{groups:t,global:e}=se(),{data:n,set:o}=$e(),{general:r}=xe(),{translation:a}=P(),{t:l}=a("Proxies"),i=c.exports.useMemo(()=>r.mode==="global"?[e]:t,[r,t,e]);return s.createElement(s.Fragment,null,i.length!==0&&s.createElement("div",{className:"flex flex-col"},s.createElement(U,{title:l("groupTitle")},s.createElement(_e,{className:"text-primary-600 text-sm text-shadow-primary cursor-pointer",checked:n.breakConnections,onChange:u=>o("breakConnections",u)},l("breakConnectionsText"))),s.createElement(O,{className:"my-2.5 md:my-4 p-0"},s.createElement("ul",{className:"list-none"},i.map(u=>s.createElement("li",{className:"proxies-group-item",key:u.name},s.createElement(Mt,{config:u})))))))}function Wt(){const{providers:t}=Me(),{translation:e}=P(),{t:n}=e("Proxies");return s.createElement(s.Fragment,null,t.length!==0&&s.createElement("div",{className:"flex flex-col"},s.createElement(U,{title:n("providerTitle")}),s.createElement("ul",{className:"list-none"},t.map(o=>s.createElement("li",{className:"my-2.5 md:my-4",key:o.name},s.createElement(Ht,{provider:o}))))))}function zt(){const{proxies:t}=se(),{translation:e}=P(),{t:n}=e("Proxies");function o(){ue.notifySpeedTest()}const{current:r,next:a}=gt([1,2,0]),l=c.exports.useMemo(()=>{switch(r){case 2:return t.slice().sort((u,d)=>ge(u,d));case 1:return t.slice().sort((u,d)=>-1*ge(u,d));default:return t.slice()}},[r,t]),i=a;return s.createElement(s.Fragment,null,l.length!==0&&s.createElement("div",{className:"flex flex-col"},s.createElement(U,{title:n("title")},s.createElement(I,{className:"ml-3",type:Ut[r],onClick:i,size:20}),s.createElement(I,{className:"ml-3",type:"speed",size:20}),s.createElement("span",{className:"proxies-speed-test",onClick:o},n("speedTestText"))),s.createElement("ul",{className:"proxies-list"},l.map(u=>s.createElement("li",{key:u.name},s.createElement(Ve,{config:u}))))))}function _t(){return s.createElement("div",{className:"page"},s.createElement(Ot,null),s.createElement(Wt,null),s.createElement(zt,null))}function Gt(){const t=c.exports.useRef(null),e=c.exports.useRef([]),[n,o]=c.exports.useState([]),{translation:r}=P(),{t:a}=r("Logs"),l=Oe();return c.exports.useLayoutEffect(()=>{const i=t.current;i&&(i.scrollTop=i.scrollHeight)}),c.exports.useEffect(()=>{function i(u){e.current=e.current.slice().concat(u.map(d=>k(C({},d),{time:new Date}))),o(e.current)}return l&&(l.subscribe("data",i),e.current=l.buffer(),o(e.current)),()=>l==null?void 0:l.unsubscribe("data",i)},[l]),s.createElement("div",{className:"page"},s.createElement(U,{title:a("title")}),s.createElement(O,{className:"flex flex-col flex-1 mt-2.5 md:mt-4"},s.createElement("ul",{className:"logs-panel",ref:t},n.map((i,u)=>s.createElement("li",{className:"leading-5 inline-block",key:u},s.createElement("span",{className:"mr-4 text-gray-400 text-opacity-90"},ie(i.time).format("YYYY-MM-DD HH:mm:ss")),s.createElement("span",null,"[",i.type,"] ",i.payload))))))}function jt(t){const{update:e}=Ie(),{translation:n,lang:o}=P(),r=A(),{provider:a}=t,{t:l}=n("Rules"),{visible:i,hide:u,show:d}=de();function p(){d(),r.updateRuleProvider(a.name).then(()=>e()).finally(()=>u())}const m=y("rule-provider-icon",{"rule-provider-loading":i});return c.exports.createElement(O,{className:"rule-provider"},c.exports.createElement("div",{className:"rule-provider-header"},c.exports.createElement("div",{className:"rule-provider-header-part"},c.exports.createElement("span",{className:"rule-provider-name"},a.name),c.exports.createElement(oe,null,a.vehicleType),c.exports.createElement(oe,{className:"rule-provider-behavior"},a.behavior),c.exports.createElement("span",{className:"rule-provider-update"},`${l("ruleCount")}: ${a.ruleCount}`)),c.exports.createElement("div",{className:"rule-provider-header-part"},a.updatedAt&&c.exports.createElement("span",{className:"rule-provider-update"},`${l("providerUpdateTime")}: ${Ee(new Date(a.updatedAt),o)}`),c.exports.createElement(I,{className:m,type:"update",size:18,onClick:p}))))}function Vt(){const{providers:t}=Ie(),{translation:e}=P(),{t:n}=e("Rules");return s.createElement(s.Fragment,null,t.length!==0&&s.createElement("div",{className:"flex flex-col"},s.createElement(U,{title:n("providerTitle")}),s.createElement("ul",{className:"proxies-providers-list"},t.map(o=>s.createElement("li",{className:"proxies-providers-item",key:o.name},s.createElement(jt,{provider:o}))))))}function Jt(){const{rules:t,update:e}=Dt(),{translation:n}=P(),{t:o}=n("Rules");_("rules",e);function r({index:a,style:l}){const i=t[a];return s.createElement("li",{className:"rule-item",style:l},s.createElement("div",{className:"py-1 flex"},s.createElement("div",{className:"rule-type w-40 text-center"},i.type),s.createElement("div",{className:"payload flex-1 text-center"},i.payload),s.createElement("div",{className:"rule-proxy w-40 text-center"},i.proxy)))}return s.createElement("div",{className:"page"},s.createElement(Vt,null),s.createElement(U,{title:o("title")}),s.createElement(O,{className:"flex flex-col flex-1 mt-2.5 md:mt-4 p-0 focus:outline-none"},s.createElement(rt,{className:"rules"},({height:a,width:l})=>s.createElement(at,{height:a,width:l,itemCount:t.length,itemSize:50},r))))}const Xt=[{label:"\u4E2D\u6587",value:"zh_CN"},{label:"English",value:"en_US"}];function Yt(){var ee,f,v;const{premium:t}=ne(),{data:e,update:n}=Ue(),{general:o,update:r}=xe(),a=ce(he),l=Z(),{translation:i,setLang:u,lang:d}=P(),{t:p}=i("Settings"),m=A(),[x,E]=me({socks5ProxyPort:7891,httpProxyPort:7890,mixedProxyPort:0});c.exports.useEffect(()=>{var h,M,ve;E("socks5ProxyPort",(h=o==null?void 0:o.socksPort)!=null?h:0),E("httpProxyPort",(M=o==null?void 0:o.port)!=null?M:0),E("mixedProxyPort",(ve=o==null?void 0:o.mixedPort)!=null?ve:0)},[o,E]);async function w(h){await m.updateConfig({mode:h}),await r()}async function F(h){await(b==null?void 0:b.setStartAtLogin(h)),n()}async function D(h){await(b==null?void 0:b.setSystemProxy(h)),n()}function L(h){u(h)}async function S(){await m.updateConfig({port:x.httpProxyPort}),await r()}async function N(){await m.updateConfig({"socks-port":x.socks5ProxyPort}),await r()}async function T(){await m.updateConfig({"mixed-port":x.mixedProxyPort}),await r()}async function j(h){await m.updateConfig({"allow-lan":h}),await r()}const{hostname:W,port:V}=l,{allowLan:$,mode:Y}=o,q=(ee=e==null?void 0:e.startAtLogin)!=null?ee:!1,re=(f=e==null?void 0:e.systemProxy)!=null?f:!1,R=(v=e==null?void 0:e.isClashX)!=null?v:!1,ae=c.exports.useMemo(()=>{const h=[{label:p("values.global"),value:"Global"},{label:p("values.rules"),value:"Rule"},{label:p("values.direct"),value:"Direct"}];return t&&h.push({label:p("values.script"),value:"Script"}),h},[p,t]);return s.createElement("div",{className:"page"},s.createElement(U,{title:p("title")}),s.createElement(O,{className:"settings-card"},s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.startAtLogin")),s.createElement(pe,{disabled:!(e==null?void 0:e.isClashX),checked:q,onChange:F})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.language")),s.createElement(Ae,{options:Xt,value:d,onSelect:h=>L(h)}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.setAsSystemProxy")),s.createElement(pe,{disabled:!R,checked:re,onChange:D})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.allowConnectFromLan")),s.createElement(pe,{checked:$,onChange:j})))),s.createElement(O,{className:"settings-card"},s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.proxyMode")),s.createElement(Ae,{options:ae,value:lt(Y),onSelect:w})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.socks5ProxyPort")),s.createElement(X,{className:"w-28",disabled:R,value:x.socks5ProxyPort,onChange:h=>E("socks5ProxyPort",+h),onBlur:N}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.httpProxyPort")),s.createElement(X,{className:"w-28",disabled:R,value:x.httpProxyPort,onChange:h=>E("httpProxyPort",+h),onBlur:S})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.mixedProxyPort")),s.createElement(X,{className:"w-28",disabled:R,value:x.mixedProxyPort,onChange:h=>E("mixedProxyPort",+h),onBlur:T}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.externalController")),s.createElement("span",{className:y({"modify-btn":!R},"external-controller"),onClick:()=>!R&&a(!1)},`${W}:${V}`)),s.createElement("div",{className:"w-1/2 px-8"}))))}var qt="./assets/logo.b453e72f.png";function Kt(t){const{routes:e}=t,{translation:n}=P(),{version:o,premium:r}=ne(),{data:a}=Ue(),{t:l}=n("SideBar"),i=e.map(({path:u,name:d,exact:p,noMobile:m})=>c.exports.createElement("li",{className:y("item",{"no-mobile":m}),key:d},c.exports.createElement(ct,{to:u,activeClassName:"active",exact:!!p},l(d))));return c.exports.createElement("div",{className:"sidebar"},c.exports.createElement("img",{src:qt,alt:"logo",className:"sidebar-logo"}),c.exports.createElement("ul",{className:"sidebar-menu"},i),c.exports.createElement("div",{className:"sidebar-version"},c.exports.createElement("span",{className:"sidebar-version-label"},"Clash",(a==null?void 0:a.isClashX)&&"X"," ",l("Version")),c.exports.createElement("span",{className:"sidebar-version-text"},o),r&&c.exports.createElement("span",{className:"sidebar-version-label"},"Premium")))}var ye;(function(t){t.Domain="Domain",t.DomainSuffix="DomainSuffix",t.DomainKeyword="DomainKeyword",t.GeoIP="GeoIP",t.IPCIDR="IPCIDR",t.SrcIPCIDR="SrcIPCIDR",t.SrcPort="SrcPort",t.DstPort="DstPort",t.MATCH="MATCH",t.RuleSet="RuleSet"})(ye||(ye={}));function Qt(t){const{translation:e}=P(),n=c.exports.useMemo(()=>e("Connections").t,[e]),{className:o,style:r}=t,a=y("connections-devices",o);function l(i){var u;(u=t.onChange)==null||u.call(t,i)}return s.createElement("div",{className:a,style:r},s.createElement("div",{className:y("connections-devices-item",{selected:t.selected===""}),onClick:()=>l("")},n("filter.all")),t.devices.map(i=>s.createElement("div",{key:i.label,className:y("connections-devices-item",{selected:t.selected===i.label}),onClick:()=>l(i.label)},i.label," (",i.number,")")))}class Zt{constructor(){this.connections=new Map,this.saveDisconnection=!1}appendToSet(e){var o;const n=e.reduce((r,a)=>r.set(a.id,a),new Map);for(const r of this.connections.keys())if(!n.has(r))if(!this.saveDisconnection)this.connections.delete(r);else{const a=this.connections.get(r);a&&(a.completed=!0,a.uploadSpeed=0,a.downloadSpeed=0)}for(const r of n.keys()){if(!this.connections.has(r)){this.connections.set(r,k(C({},n.get(r)),{uploadSpeed:0,downloadSpeed:0}));continue}const a=this.connections.get(r),l=n.get(r);(o=this.connections)==null||o.set(r,k(C({},l),{uploadSpeed:l.upload-a.upload,downloadSpeed:l.download-a.download}))}}toggleSave(){var e,n;if(this.saveDisconnection){this.saveDisconnection=!1;for(const o of this.connections.keys())((n=(e=this.connections)==null?void 0:e.get(o))==null?void 0:n.completed)&&this.connections.delete(o)}else this.saveDisconnection=!0;return this.saveDisconnection}getConnections(){return[...this.connections.values()]}}function en(){const t=c.exports.useMemo(()=>new Zt,[]),e=c.exports.useRef(!0),[n,o]=c.exports.useState([]),[r,a]=c.exports.useState(!1),l=c.exports.useCallback(function(u){t.appendToSet(u),e.current&&o(t.getConnections()),e.current=!e.current},[t]),i=c.exports.useCallback(function(){const u=t.toggleSave();a(u),u||o(t.getConnections()),e.current=!0},[t]);return{connections:n,feed:l,toggleSave:i,save:r}}var g;(function(t){t.Host="host",t.Network="network",t.Type="type",t.Chains="chains",t.Rule="rule",t.Speed="speed",t.Upload="upload",t.Download="download",t.SourceIP="sourceIP",t.Time="time"})(g||(g={}));const tn=new Set([g.Network,g.Type,g.Rule,g.Speed,g.Upload,g.Download,g.SourceIP,g.Time]);function G(t){const e=["B","KB","MB","GB","TB"];let n=0;for(;~~(t/1024)&&n<e.length;)t/=1024,n++;return`${n===0?t:t.toFixed(2)} ${e[n]}`}function nn(t,e){switch(!0){case(t===0&&e===0):return"-";case(t!==0&&e!==0):return`\u2191 ${G(t)}/s \u2193 ${G(e)}/s`;case t!==0:return`\u2191 ${G(t)}/s`;default:return`\u2193 ${G(e)}/s`}}function sn(){const{translation:t,lang:e}=P(),n=c.exports.useMemo(()=>t("Connections").t,[t]),o=Tt(),r=A(),[a,l]=me({uploadTotal:0,downloadTotal:0}),{visible:i,show:u,hide:d}=de();function p(){r.closeAllConnections().finally(()=>d())}const{connections:m,feed:x,save:E,toggleSave:w}=en(),F=c.exports.useMemo(()=>m.map(f=>({id:f.id,host:`${f.metadata.host||f.metadata.destinationIP}:${f.metadata.destinationPort}`,chains:f.chains.slice().reverse().join(" / "),rule:f.rule===ye.RuleSet?`${f.rule}(${f.rulePayload})`:f.rule,time:new Date(f.start).getTime(),upload:f.upload,download:f.download,sourceIP:f.metadata.sourceIP,type:f.metadata.type,network:f.metadata.network.toUpperCase(),speed:{upload:f.uploadSpeed,download:f.downloadSpeed},completed:!!f.completed})),[m]),D=c.exports.useMemo(()=>{const f=it(m,"metadata.sourceIP");return Object.keys(f).map(v=>({label:v,number:f[v].length})).sort((v,h)=>v.label.localeCompare(h.label))},[m]),L=c.exports.useRef(null),{x:S}=ut(L),N=c.exports.useMemo(()=>[{Header:n(`columns.${g.Host}`),accessor:g.Host,minWidth:260,width:260},{Header:n(`columns.${g.Network}`),accessor:g.Network,minWidth:80,width:80},{Header:n(`columns.${g.Type}`),accessor:g.Type,minWidth:120,width:120},{Header:n(`columns.${g.Chains}`),accessor:g.Chains,minWidth:200,width:200},{Header:n(`columns.${g.Rule}`),accessor:g.Rule,minWidth:140,width:140},{id:g.Speed,Header:n(`columns.${g.Speed}`),accessor(f){return[f.speed.upload,f.speed.download]},sortType(f,v){const h=f.original.speed,M=v.original.speed;return h.download===M.download?h.upload-M.upload:h.download-M.download},minWidth:200,width:200,sortDescFirst:!0},{Header:n(`columns.${g.Upload}`),accessor:g.Upload,minWidth:100,width:100,sortDescFirst:!0},{Header:n(`columns.${g.Download}`),accessor:g.Download,minWidth:100,width:100,sortDescFirst:!0},{Header:n(`columns.${g.SourceIP}`),accessor:g.SourceIP,minWidth:140,width:140},{Header:n(`columns.${g.Time}`),accessor:g.Time,minWidth:120,width:120,sortType(f,v){return v.original.time-f.original.time}}],[n]);c.exports.useLayoutEffect(()=>{function f(v){for(const h of v)l({uploadTotal:h.uploadTotal,downloadTotal:h.downloadTotal}),x(h.connections)}return o==null||o.subscribe("data",f),()=>{o==null||o.unsubscribe("data",f),o==null||o.destory()}},[o,x,l]);const{getTableProps:T,getTableBodyProps:j,headerGroups:W,rows:V,prepareRow:$,setFilter:Y}=K.exports.useTable({columns:N,data:F,autoResetSortBy:!1,autoResetFilters:!1,initialState:{sortBy:[{id:g.Time,desc:!1}]}},K.exports.useResizeColumns,K.exports.useBlockLayout,K.exports.useFilters,K.exports.useSortBy),q=c.exports.useMemo(()=>W[0],[W]),re=c.exports.useCallback(function(f){switch(f.column.id){case g.Speed:return nn(f.value[0],f.value[1]);case g.Upload:case g.Download:return G(f.value);case g.Time:return Ee(new Date(f.value),e);default:return f.value}},[e]),[R,ae]=c.exports.useState("");function ee(f){ae(f),Y==null||Y(g.SourceIP,f)}return s.createElement("div",{className:"page"},s.createElement(U,{title:n("title")},s.createElement("span",{className:"connections-filter flex-1 cursor-default"},`(${n("total.text")}: ${n("total.upload")} ${G(a.uploadTotal)} ${n("total.download")} ${G(a.downloadTotal)})`),s.createElement(_e,{className:"connections-filter",checked:E,onChange:w},n("keepClosed")),s.createElement(I,{className:"connections-filter dangerous",onClick:u,type:"close-all",size:20})),D.length>1&&s.createElement(Qt,{devices:D,selected:R,onChange:ee}),s.createElement(O,{className:"connections-card"},s.createElement("div",k(C({},T()),{className:"flex flex-col w-full flex-1 overflow-auto",style:{flexBasis:0},ref:L}),s.createElement("div",k(C({},q.getHeaderGroupProps()),{className:"connections-header"}),q.headers.map((f,v)=>{const h=f,M=h.id;return s.createElement("div",k(C({},h.getHeaderProps()),{className:y("connections-th",{resizing:h.isResizing,fixed:S>0&&h.id===g.Host}),key:M}),s.createElement("div",C({},h.getSortByToggleProps()),f.render("Header"),h.isSorted?h.isSortedDesc?" \u2193":" \u2191":null),v!==q.headers.length-1&&s.createElement("div",k(C({},h.getResizerProps()),{className:"connections-resizer"})))})),s.createElement("div",k(C({},j()),{className:"flex-1"}),V.map(f=>($(f),s.createElement("div",k(C({},f.getRowProps()),{className:"connections-item",key:f.original.id}),f.cells.map(v=>{const h=y("connections-block",{"text-center":tn.has(v.column.id),completed:f.original.completed},{fixed:S>0&&v.column.id===g.Host});return s.createElement("div",k(C({},v.getCellProps()),{className:h,key:v.column.id}),re(v))}))))))),s.createElement(We,{title:n("closeAll.title"),show:i,onClose:d,onOk:p},n("closeAll.content")))}function on(){const{translation:t}=P(),{t:e}=t("Settings"),{hostname:n,port:o,secret:r}=Z(),[a,l]=B(he),[i,u]=me({hostname:"",port:"",secret:""});c.exports.useEffect(()=>{u({hostname:n,port:o,secret:r})},[n,o,r,u]);const d=ce(Le);function p(){const{hostname:m,port:x,secret:E}=i;d([{hostname:m,port:x,secret:E}])}return s.createElement(We,{show:!a,title:e("externalControllerSetting.title"),bodyClassName:"external-controller",onClose:()=>l(!0),onOk:p},s.createElement($t,{type:"info",inside:!0},s.createElement("p",null,e("externalControllerSetting.note"))),s.createElement("div",{className:"flex items-center"},s.createElement("span",{className:"md:my-3 w-14 my-1 font-bold"},e("externalControllerSetting.host")),s.createElement(X,{className:"md:my-3 flex-1 my-1",align:"left",inside:!0,value:i.hostname,onChange:m=>u("hostname",m)})),s.createElement("div",{className:"flex items-center"},s.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},e("externalControllerSetting.port")),s.createElement(X,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.port,onChange:m=>u("port",m)})),s.createElement("div",{className:"flex items-center"},s.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},e("externalControllerSetting.secret")),s.createElement(X,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.secret,onChange:m=>u("secret",m)})))}function rn(){Oe();const t=[{path:"/proxies",name:"Proxies",component:_t},{path:"/logs",name:"Logs",component:Gt},{path:"/rules",name:"Rules",component:Jt,noMobile:!0},{path:"/connections",name:"Connections",component:sn,noMobile:!0},{path:"/settings",name:"Settings",component:Yt}];return s.createElement("div",{className:y("app",{"not-clashx":!J()})},s.createElement(Kt,{routes:t}),s.createElement("div",{className:"page-container"},s.createElement(mt,null,s.createElement(Fe,{exact:!0,path:"/",component:()=>s.createElement(dt,{to:"/proxies"})}),t.map(e=>s.createElement(Fe,{exact:!1,path:e.path,key:e.path,component:e.component})))),s.createElement(on,null))}function Xe(){const t=document.getElementById("root"),e=s.createElement(pt,null,s.createElement(c.exports.Suspense,{fallback:s.createElement(Ge,{visible:!0})},s.createElement(rn,null)));ke.exports.render(e,t)}J()?ht(()=>Xe()):Xe();
